{"version":3,"sources":["public/src/admin/advanced/errors.js"],"names":["define","Chart","Errors","init","setupCharts","$","on","clear404","bootbox","confirm","ok","socket","emit","err","app","alertError","message","ajaxify","refresh","alertSuccess","notFoundCanvas","document","getElementById","tooBusyCanvas","dailyLabels","utils","getDaysArray","slice","isMobile","defaults","global","tooltips","enabled","data","not-found","labels","datasets","label","backgroundColor","borderColor","pointBackgroundColor","pointHoverBackgroundColor","pointBorderColor","pointHoverBorderColor","analytics","toobusy","width","parent","getContext","type","options","responsive","legend","display","scales","yAxes","ticks","beginAtZero"],"mappings":"AAAA,aAGAA,OAAO,yBAA0B,SAAU,SAAUC,GACpD,IAAIC,KAEJA,EAAOC,KAAO,WACbD,EAAOE,cAEPC,EAAE,yBAAyBC,GAAG,QAASJ,EAAOK,WAG/CL,EAAOK,SAAW,WACjBC,QAAQC,QAAQ,6CAA8C,SAAUC,GACvE,GAAIA,EAAI,CACPC,OAAOC,KAAK,wBAA0B,SAAUC,GAC/C,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAIG,SAG3BC,QAAQC,UACRJ,IAAIK,aAAa,oDAMrBjB,EAAOE,YAAc,WACpB,IAAIgB,EAAiBC,SAASC,eAAe,aAC7C,IAAIC,EAAgBF,SAASC,eAAe,WAC5C,IAAIE,EAAcC,MAAMC,eAExBF,EAAcA,EAAYG,OAAO,GAEjC,GAAIF,MAAMG,WAAY,CACrB3B,EAAM4B,SAASC,OAAOC,SAASC,QAAU,MAG1C,IAAIC,GACHC,aACCC,OAAQX,EACRY,WAEEC,MAAO,GACPC,gBAAiB,wBACjBC,YAAa,sBACbC,qBAAsB,sBACtBC,0BAA2B,OAC3BC,iBAAkB,OAClBC,sBAAuB,sBACvBV,KAAMhB,QAAQgB,KAAKW,UAAU,gBAIhCC,SACCV,OAAQX,EACRY,WAEEC,MAAO,GACPC,gBAAiB,wBACjBC,YAAa,sBACbC,qBAAsB,sBACtBC,0BAA2B,OAC3BC,iBAAkB,OAClBC,sBAAuB,sBACvBV,KAAMhB,QAAQgB,KAAKW,UAAUC,YAMjCzB,EAAe0B,MAAQzC,EAAEe,GAAgB2B,SAASD,QAClDvB,EAAcuB,MAAQzC,EAAEkB,GAAewB,SAASD,QAEhD,IAAI7C,EAAMmB,EAAe4B,WAAW,OACnCC,KAAM,OACNhB,KAAMA,EAAK,aACXiB,SACCC,WAAY,KACZC,QACCC,QAAS,OAEVC,QACCC,QACCC,OACCC,YAAa,YAOlB,IAAIxD,EAAMsB,EAAcyB,WAAW,OAClCC,KAAM,OACNhB,KAAMA,EAAKY,QACXK,SACCC,WAAY,KACZC,QACCC,QAAS,OAEVC,QACCC,QACCC,OACCC,YAAa,aAQnB,OAAOvD","file":"public/src/admin/advanced/errors.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('admin/advanced/errors', ['Chart'], function (Chart) {\r\n\tvar Errors = {};\r\n\r\n\tErrors.init = function () {\r\n\t\tErrors.setupCharts();\r\n\r\n\t\t$('[data-action=\"clear\"]').on('click', Errors.clear404);\r\n\t};\r\n\r\n\tErrors.clear404 = function () {\r\n\t\tbootbox.confirm('[[admin/advanced/errors:clear404-confirm]]', function (ok) {\r\n\t\t\tif (ok) {\r\n\t\t\t\tsocket.emit('admin.errors.clear', {}, function (err) {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tajaxify.refresh();\r\n\t\t\t\t\tapp.alertSuccess('[[admin/advanced/errors:clear404-success]]');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tErrors.setupCharts = function () {\r\n\t\tvar notFoundCanvas = document.getElementById('not-found');\r\n\t\tvar tooBusyCanvas = document.getElementById('toobusy');\r\n\t\tvar dailyLabels = utils.getDaysArray();\r\n\r\n\t\tdailyLabels = dailyLabels.slice(-7);\r\n\r\n\t\tif (utils.isMobile()) {\r\n\t\t\tChart.defaults.global.tooltips.enabled = false;\r\n\t\t}\r\n\r\n\t\tvar data = {\r\n\t\t\t'not-found': {\r\n\t\t\t\tlabels: dailyLabels,\r\n\t\t\t\tdatasets: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: '',\r\n\t\t\t\t\t\tbackgroundColor: 'rgba(186,139,175,0.2)',\r\n\t\t\t\t\t\tborderColor: 'rgba(186,139,175,1)',\r\n\t\t\t\t\t\tpointBackgroundColor: 'rgba(186,139,175,1)',\r\n\t\t\t\t\t\tpointHoverBackgroundColor: '#fff',\r\n\t\t\t\t\t\tpointBorderColor: '#fff',\r\n\t\t\t\t\t\tpointHoverBorderColor: 'rgba(186,139,175,1)',\r\n\t\t\t\t\t\tdata: ajaxify.data.analytics['not-found'],\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\ttoobusy: {\r\n\t\t\t\tlabels: dailyLabels,\r\n\t\t\t\tdatasets: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: '',\r\n\t\t\t\t\t\tbackgroundColor: 'rgba(151,187,205,0.2)',\r\n\t\t\t\t\t\tborderColor: 'rgba(151,187,205,1)',\r\n\t\t\t\t\t\tpointBackgroundColor: 'rgba(151,187,205,1)',\r\n\t\t\t\t\t\tpointHoverBackgroundColor: '#fff',\r\n\t\t\t\t\t\tpointBorderColor: '#fff',\r\n\t\t\t\t\t\tpointHoverBorderColor: 'rgba(151,187,205,1)',\r\n\t\t\t\t\t\tdata: ajaxify.data.analytics.toobusy,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tnotFoundCanvas.width = $(notFoundCanvas).parent().width();\r\n\t\ttooBusyCanvas.width = $(tooBusyCanvas).parent().width();\r\n\r\n\t\tnew Chart(notFoundCanvas.getContext('2d'), {\r\n\t\t\ttype: 'line',\r\n\t\t\tdata: data['not-found'],\r\n\t\t\toptions: {\r\n\t\t\t\tresponsive: true,\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tdisplay: false,\r\n\t\t\t\t},\r\n\t\t\t\tscales: {\r\n\t\t\t\t\tyAxes: [{\r\n\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\tbeginAtZero: true,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}],\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tnew Chart(tooBusyCanvas.getContext('2d'), {\r\n\t\t\ttype: 'line',\r\n\t\t\tdata: data.toobusy,\r\n\t\t\toptions: {\r\n\t\t\t\tresponsive: true,\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tdisplay: false,\r\n\t\t\t\t},\r\n\t\t\t\tscales: {\r\n\t\t\t\t\tyAxes: [{\r\n\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\tbeginAtZero: true,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}],\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\treturn Errors;\r\n});\r\n"]}