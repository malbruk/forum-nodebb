{"version":3,"sources":["public/src/admin/modules/instance.js"],"names":["define","config","relative_path","instance","rebuildAndRestart","callback","app","alert","alert_id","type","title","message","$","window","one","timeout","socket","emit","restart"],"mappings":"AAAA,aAEAA,OAAO,0BAINC,OAAOC,cAAgB,8BACrB,WACF,IAAIC,KAEJA,EAASC,kBAAoB,SAAUC,GACtCC,IAAIC,OACHC,SAAU,+BACVC,KAAM,OACNC,MAAO,sDACPC,QAAS,kEAGVC,EAAEC,QAAQC,IAAI,qBAAsB,WACnCR,IAAIC,OACHC,SAAU,+BACVC,KAAM,UACNC,MAAO,sCACPC,QAAS,iDACTI,QAAS,MAGV,UAAWV,IAAa,WAAY,CACnCA,OAIFW,OAAOC,KAAK,eAAgB,WAC3BX,IAAIC,OACHC,SAAU,+BACVC,KAAM,OACNC,MAAO,2DACPC,QAAS,6BAKZR,EAASe,QAAU,SAAUb,GAC5BC,IAAIC,OACHC,SAAU,mBACVC,KAAM,OACNC,MAAO,sDACPC,QAAS,0BAGVC,EAAEC,QAAQC,IAAI,qBAAsB,WACnCR,IAAIC,OACHC,SAAU,mBACVC,KAAM,UACNC,MAAO,sCACPC,QAAS,qCACTI,QAAS,MAGV,UAAWV,IAAa,WAAY,CACnCA,OAIFW,OAAOC,KAAK,kBAGb,OAAOd","file":"public/src/admin/modules/instance.js","sourcesContent":["'use strict';\r\n\r\ndefine('admin/modules/instance', [\r\n\t// need to preload the compiled alert template\r\n\t// otherwise it can be unloaded when rebuild & restart is run\r\n\t// the client can't fetch the template file, resulting in an error\r\n\tconfig.relative_path + '/assets/templates/alert.js',\r\n], function () {\r\n\tvar instance = {};\r\n\r\n\tinstance.rebuildAndRestart = function (callback) {\r\n\t\tapp.alert({\r\n\t\t\talert_id: 'instance_rebuild_and_restart',\r\n\t\t\ttype: 'info',\r\n\t\t\ttitle: 'Rebuilding... <i class=\"fa fa-spin fa-refresh\"></i>',\r\n\t\t\tmessage: 'NodeBB is rebuilding front-end assets (css, javascript, etc).',\r\n\t\t});\r\n\r\n\t\t$(window).one('action:reconnected', function () {\r\n\t\t\tapp.alert({\r\n\t\t\t\talert_id: 'instance_rebuild_and_restart',\r\n\t\t\t\ttype: 'success',\r\n\t\t\t\ttitle: '<i class=\"fa fa-check\"></i> Success',\r\n\t\t\t\tmessage: 'NodeBB has rebuilt and restarted successfully.',\r\n\t\t\t\ttimeout: 5000,\r\n\t\t\t});\r\n\r\n\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\tcallback();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsocket.emit('admin.reload', function () {\r\n\t\t\tapp.alert({\r\n\t\t\t\talert_id: 'instance_rebuild_and_restart',\r\n\t\t\t\ttype: 'info',\r\n\t\t\t\ttitle: 'Build Complete!... <i class=\"fa fa-spin fa-refresh\"></i>',\r\n\t\t\t\tmessage: 'NodeBB is restarting.',\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tinstance.restart = function (callback) {\r\n\t\tapp.alert({\r\n\t\t\talert_id: 'instance_restart',\r\n\t\t\ttype: 'info',\r\n\t\t\ttitle: 'Restarting... <i class=\"fa fa-spin fa-refresh\"></i>',\r\n\t\t\tmessage: 'NodeBB is restarting.',\r\n\t\t});\r\n\r\n\t\t$(window).one('action:reconnected', function () {\r\n\t\t\tapp.alert({\r\n\t\t\t\talert_id: 'instance_restart',\r\n\t\t\t\ttype: 'success',\r\n\t\t\t\ttitle: '<i class=\"fa fa-check\"></i> Success',\r\n\t\t\t\tmessage: 'NodeBB has restarted successfully.',\r\n\t\t\t\ttimeout: 5000,\r\n\t\t\t});\r\n\r\n\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\tcallback();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsocket.emit('admin.restart');\r\n\t};\r\n\r\n\treturn instance;\r\n});\r\n"]}