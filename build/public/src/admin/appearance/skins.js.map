{"version":3,"sources":["public/src/admin/appearance/skins.js"],"names":["define","translator","Skins","init","$","ajax","method","url","done","render","on","e","target","attr","parents","action","parentEl","themeType","cssSrc","themeId","socket","emit","type","id","src","err","app","alertError","message","highlightSelectedTheme","alert","alert_id","title","timeout","bootswatch","themeContainer","parseAndTranslate","themes","map","theme","name","description","screenshot_url","thumbnail","preview","css","cssCdn","skin","showRevert","html","config","match","replace","m","p1","p2","toUpperCase","translate","text","split","select","current","removeClass","find","each","this","addClass"],"mappings":"AAAA,aAGAA,OAAO,0BAA2B,cAAe,SAAUC,GAC1D,IAAIC,KAEJA,EAAMC,KAAO,WAEZC,EAAEC,MACDC,OAAQ,MACRC,IAAK,sCACHC,KAAKN,EAAMO,QAEdL,EAAE,UAAUM,GAAG,QAAS,SAAUC,GACjC,IAAIC,EAASR,EAAEO,EAAEC,QAEjB,IAAKA,EAAOC,KAAK,eAAgB,CAChCD,EAASA,EAAOE,QAAQ,iBAGzB,IAAIC,EAASH,EAAOC,KAAK,eAEzB,GAAIE,GAAUA,IAAW,MAAO,CAC/B,IAAIC,EAAWJ,EAAOE,QAAQ,gBAC9B,IAAIG,EAAYD,EAASH,KAAK,aAC9B,IAAIK,EAASF,EAASH,KAAK,YAC3B,IAAIM,EAAUH,EAASH,KAAK,cAG5BO,OAAOC,KAAK,oBACXC,KAAML,EACNM,GAAIJ,EACJK,IAAKN,GACH,SAAUO,GACZ,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAIG,SAE3BC,EAAuBV,GAEvBO,IAAII,OACHC,SAAU,cACVT,KAAM,OACNU,MAAO,0CACPJ,QAAST,EAAW,6CAA+CA,EAAU,KAAQ,4CACrFc,QAAS,YAOd/B,EAAMO,OAAS,SAAUyB,GACxB,IAAIC,EAAiB/B,EAAE,qBAEvBsB,IAAIU,kBAAkB,6BACrBC,OAAQH,EAAWG,OAAOC,IAAI,SAAUC,GACvC,OACCjB,KAAM,aACNC,GAAIgB,EAAMC,KACVA,KAAMD,EAAMC,KACZC,YAAaF,EAAME,YACnBC,eAAgBH,EAAMI,UACtBpC,IAAKgC,EAAMK,QACXC,IAAKN,EAAMO,OACXC,KAAM,QAGRC,WAAY,MACV,SAAUC,GACZd,EAAec,KAAKA,GAEpB,GAAIC,OAAO,aAAc,CACxB,IAAIH,EAAOG,OAAO,aAChBC,MAAM,oCAAoC,GAC1CC,QAAQ,iBAAkB,SAAUC,EAAGC,EAAIC,GAAM,OAAOD,EAAKC,EAAGC,gBAElE3B,EAAuBkB,OAK1B,SAASlB,EAAuBV,GAC/BlB,EAAWwD,UAAU,sFAAuF,SAAUC,GACrHA,EAAOA,EAAKC,MAAM,UAClB,IAAIC,EAASF,EAAK,GAClB,IAAIG,EAAUH,EAAK,GAEnBtD,EAAE,gBACA0D,YAAY,YACZC,KAAK,uBAAuBC,KAAK,WACjC,GAAI5D,EAAE6D,MAAMnD,QAAQ,gBAAgBD,KAAK,cAAe,CACvDT,EAAE6D,MACAhB,KAAKW,GACLE,YAAY,eACZI,SAAS,kBAId,IAAK/C,EAAS,CACb,OAGDf,EAAE,gBAAkBe,EAAU,MAC5B+C,SAAS,YACTH,KAAK,uBACLd,KAAKY,GACLC,YAAY,eACZI,SAAS,iBAIb,OAAOhE","file":"public/src/admin/appearance/skins.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('admin/appearance/skins', ['translator'], function (translator) {\r\n\tvar Skins = {};\r\n\r\n\tSkins.init = function () {\r\n\t\t// Populate skins from Bootswatch API\r\n\t\t$.ajax({\r\n\t\t\tmethod: 'get',\r\n\t\t\turl: 'https://bootswatch.com/api/3.json',\r\n\t\t}).done(Skins.render);\r\n\r\n\t\t$('#skins').on('click', function (e) {\r\n\t\t\tvar target = $(e.target);\r\n\r\n\t\t\tif (!target.attr('data-action')) {\r\n\t\t\t\ttarget = target.parents('[data-action]');\r\n\t\t\t}\r\n\r\n\t\t\tvar action = target.attr('data-action');\r\n\r\n\t\t\tif (action && action === 'use') {\r\n\t\t\t\tvar parentEl = target.parents('[data-theme]');\r\n\t\t\t\tvar themeType = parentEl.attr('data-type');\r\n\t\t\t\tvar cssSrc = parentEl.attr('data-css');\r\n\t\t\t\tvar themeId = parentEl.attr('data-theme');\r\n\r\n\r\n\t\t\t\tsocket.emit('admin.themes.set', {\r\n\t\t\t\t\ttype: themeType,\r\n\t\t\t\t\tid: themeId,\r\n\t\t\t\t\tsrc: cssSrc,\r\n\t\t\t\t}, function (err) {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thighlightSelectedTheme(themeId);\r\n\r\n\t\t\t\t\tapp.alert({\r\n\t\t\t\t\t\talert_id: 'admin:theme',\r\n\t\t\t\t\t\ttype: 'info',\r\n\t\t\t\t\t\ttitle: '[[admin/appearance/skins:skin-updated]]',\r\n\t\t\t\t\t\tmessage: themeId ? ('[[admin/appearance/skins:applied-success, ' + themeId + ']]') : '[[admin/appearance/skins:revert-success]]',\r\n\t\t\t\t\t\ttimeout: 5000,\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tSkins.render = function (bootswatch) {\r\n\t\tvar themeContainer = $('#bootstrap_themes');\r\n\r\n\t\tapp.parseAndTranslate('admin/partials/theme_list', {\r\n\t\t\tthemes: bootswatch.themes.map(function (theme) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype: 'bootswatch',\r\n\t\t\t\t\tid: theme.name,\r\n\t\t\t\t\tname: theme.name,\r\n\t\t\t\t\tdescription: theme.description,\r\n\t\t\t\t\tscreenshot_url: theme.thumbnail,\r\n\t\t\t\t\turl: theme.preview,\r\n\t\t\t\t\tcss: theme.cssCdn,\r\n\t\t\t\t\tskin: true,\r\n\t\t\t\t};\r\n\t\t\t}),\r\n\t\t\tshowRevert: true,\r\n\t\t}, function (html) {\r\n\t\t\tthemeContainer.html(html);\r\n\r\n\t\t\tif (config['theme:src']) {\r\n\t\t\t\tvar skin = config['theme:src']\r\n\t\t\t\t\t.match(/latest\\/(\\S+)\\/bootstrap.min.css/)[1]\r\n\t\t\t\t\t.replace(/(^|\\s)([a-z])/g, function (m, p1, p2) { return p1 + p2.toUpperCase(); });\r\n\r\n\t\t\t\thighlightSelectedTheme(skin);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tfunction highlightSelectedTheme(themeId) {\r\n\t\ttranslator.translate('[[admin/appearance/skins:select-skin]]  ||  [[admin/appearance/skins:current-skin]]', function (text) {\r\n\t\t\ttext = text.split('  ||  ');\r\n\t\t\tvar select = text[0];\r\n\t\t\tvar current = text[1];\r\n\r\n\t\t\t$('[data-theme]')\r\n\t\t\t\t.removeClass('selected')\r\n\t\t\t\t.find('[data-action=\"use\"]').each(function () {\r\n\t\t\t\t\tif ($(this).parents('[data-theme]').attr('data-theme')) {\r\n\t\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t\t.html(select)\r\n\t\t\t\t\t\t\t.removeClass('btn-success')\r\n\t\t\t\t\t\t\t.addClass('btn-primary');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\tif (!themeId) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t$('[data-theme=\"' + themeId + '\"]')\r\n\t\t\t\t.addClass('selected')\r\n\t\t\t\t.find('[data-action=\"use\"]')\r\n\t\t\t\t.html(current)\r\n\t\t\t\t.removeClass('btn-primary')\r\n\t\t\t\t.addClass('btn-success');\r\n\t\t});\r\n\t}\r\n\r\n\treturn Skins;\r\n});\r\n"]}