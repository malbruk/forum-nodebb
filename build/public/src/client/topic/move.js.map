{"version":3,"sources":["public/src/client/topic/move.js"],"names":["define","categorySelector","alerts","Move","modal","selectedCategory","init","tids","currentCid","onComplete","moveAll","showModal","app","parseAndTranslate","html","on","remove","find","addClass","length","translateText","onSelect","onCategorySelected","privilege","onCommitClicked","category","prop","commitEl","cid","message","name","data","slice","alert","alert_id","join","title","type","timeout","timeoutfn","moveTopics","clickfn","params","alertSuccess","$","window","trigger","socket","emit","err","alertError"],"mappings":"AAAA,aAGAA,OAAO,oBAAqB,mBAAoB,UAAW,SAAUC,EAAkBC,GACtF,IAAIC,KACJ,IAAIC,EACJ,IAAIC,EAEJF,EAAKG,KAAO,SAAUC,EAAMC,EAAYC,GACvCN,EAAKI,KAAOA,EACZJ,EAAKK,WAAaA,EAClBL,EAAKM,WAAaA,EAClBN,EAAKO,SAAWH,EAEhBI,KAGD,SAASA,IACRC,IAAIC,kBAAkB,gCAAkC,SAAUC,GACjEV,EAAQU,EACRV,EAAMW,GAAG,kBAAmB,WAC3BX,EAAMY,WAGPZ,EAAMa,KAAK,iBAAiBC,SAAS,QAErC,GAAIf,EAAKO,SAAYP,EAAKI,MAAQJ,EAAKI,KAAKY,OAAS,EAAI,CACxDf,EAAMa,KAAK,oBAAoBG,cAAc,yBAG9CnB,EAAiBK,KAAKF,EAAMa,KAAK,oCAChCI,SAAUC,EACVC,UAAW,aAGZnB,EAAMa,KAAK,uBAAuBF,GAAG,QAASS,GAE9CpB,EAAMA,MAAM,UAId,SAASkB,EAAmBG,GAC3BpB,EAAmBoB,EACnBrB,EAAMa,KAAK,uBAAuBS,KAAK,WAAY,OAGpD,SAASF,IACR,IAAIG,EAAWvB,EAAMa,KAAK,uBAE1B,IAAKU,EAASD,KAAK,aAAerB,GAAoBA,EAAiBuB,IAAK,CAC3ED,EAASD,KAAK,WAAY,MAE1BtB,EAAMA,MAAM,QACZ,IAAIyB,EAAU,+BAAiCxB,EAAiByB,KAAO,KACvE,GAAI3B,EAAKI,MAAQJ,EAAKI,KAAKY,OAAS,EAAG,CACtCU,EAAU,wCAA0CxB,EAAiByB,KAAO,UACtE,IAAK3B,EAAKI,KAAM,CACtBsB,EAAU,mCAAqCxB,EAAiByB,KAAO,KAExE,IAAIC,GACHxB,KAAMJ,EAAKI,KAAOJ,EAAKI,KAAKyB,QAAU,KACtCJ,IAAKvB,EAAiBuB,IACtBpB,WAAYL,EAAKK,WACjBC,WAAYN,EAAKM,YAElBP,EAAO+B,OACNC,SAAU,cAAgB/B,EAAKI,KAAOJ,EAAKI,KAAK4B,KAAK,KAAO,OAC5DC,MAAO,8BACPP,QAASA,EACTQ,KAAM,UACNC,QAAS,IACTC,UAAW,WACVC,EAAWT,IAEZU,QAAS,SAAUR,EAAOS,UAClBA,EAAOH,UACd3B,IAAI+B,aAAa,mCAMrB,SAASH,EAAWT,GACnBa,EAAEC,QAAQC,QAAQ,oBAAqBf,GAEvCgB,OAAOC,MAAMjB,EAAKxB,KAAO,iBAAmB,cAAewB,EAAM,SAAUkB,GAC1E,GAAIA,EAAK,CACR,OAAOrC,IAAIsC,WAAWD,EAAIpB,SAG3B,UAAWE,EAAKtB,aAAe,WAAY,CAC1CsB,EAAKtB,gBAKR,OAAON","file":"public/src/client/topic/move.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/topic/move', ['categorySelector', 'alerts'], function (categorySelector, alerts) {\r\n\tvar Move = {};\r\n\tvar modal;\r\n\tvar selectedCategory;\r\n\r\n\tMove.init = function (tids, currentCid, onComplete) {\r\n\t\tMove.tids = tids;\r\n\t\tMove.currentCid = currentCid;\r\n\t\tMove.onComplete = onComplete;\r\n\t\tMove.moveAll = !tids;\r\n\r\n\t\tshowModal();\r\n\t};\r\n\r\n\tfunction showModal() {\r\n\t\tapp.parseAndTranslate('partials/move_thread_modal', {}, function (html) {\r\n\t\t\tmodal = html;\r\n\t\t\tmodal.on('hidden.bs.modal', function () {\r\n\t\t\t\tmodal.remove();\r\n\t\t\t});\r\n\r\n\t\t\tmodal.find('#move-confirm').addClass('hide');\r\n\r\n\t\t\tif (Move.moveAll || (Move.tids && Move.tids.length > 1)) {\r\n\t\t\t\tmodal.find('.modal-header h3').translateText('[[topic:move_topics]]');\r\n\t\t\t}\r\n\r\n\t\t\tcategorySelector.init(modal.find('[component=\"category-selector\"]'), {\r\n\t\t\t\tonSelect: onCategorySelected,\r\n\t\t\t\tprivilege: 'moderate',\r\n\t\t\t});\r\n\r\n\t\t\tmodal.find('#move_thread_commit').on('click', onCommitClicked);\r\n\r\n\t\t\tmodal.modal('show');\r\n\t\t});\r\n\t}\r\n\r\n\tfunction onCategorySelected(category) {\r\n\t\tselectedCategory = category;\r\n\t\tmodal.find('#move_thread_commit').prop('disabled', false);\r\n\t}\r\n\r\n\tfunction onCommitClicked() {\r\n\t\tvar commitEl = modal.find('#move_thread_commit');\r\n\r\n\t\tif (!commitEl.prop('disabled') && selectedCategory && selectedCategory.cid) {\r\n\t\t\tcommitEl.prop('disabled', true);\r\n\r\n\t\t\tmodal.modal('hide');\r\n\t\t\tvar message = '[[topic:topic_move_success, ' + selectedCategory.name + ']]';\r\n\t\t\tif (Move.tids && Move.tids.length > 1) {\r\n\t\t\t\tmessage = '[[topic:topic_move_multiple_success, ' + selectedCategory.name + ']]';\r\n\t\t\t} else if (!Move.tids) {\r\n\t\t\t\tmessage = '[[topic:topic_move_all_success, ' + selectedCategory.name + ']]';\r\n\t\t\t}\r\n\t\t\tvar data = {\r\n\t\t\t\ttids: Move.tids ? Move.tids.slice() : null,\r\n\t\t\t\tcid: selectedCategory.cid,\r\n\t\t\t\tcurrentCid: Move.currentCid,\r\n\t\t\t\tonComplete: Move.onComplete,\r\n\t\t\t};\r\n\t\t\talerts.alert({\r\n\t\t\t\talert_id: 'tids_move_' + (Move.tids ? Move.tids.join('-') : 'all'),\r\n\t\t\t\ttitle: '[[topic:thread_tools.move]]',\r\n\t\t\t\tmessage: message,\r\n\t\t\t\ttype: 'success',\r\n\t\t\t\ttimeout: 10000,\r\n\t\t\t\ttimeoutfn: function () {\r\n\t\t\t\t\tmoveTopics(data);\r\n\t\t\t\t},\r\n\t\t\t\tclickfn: function (alert, params) {\r\n\t\t\t\t\tdelete params.timeoutfn;\r\n\t\t\t\t\tapp.alertSuccess('[[topic:topic_move_undone]]');\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction moveTopics(data) {\r\n\t\t$(window).trigger('action:topic.move', data);\r\n\r\n\t\tsocket.emit(!data.tids ? 'topics.moveAll' : 'topics.move', data, function (err) {\r\n\t\t\tif (err) {\r\n\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof data.onComplete === 'function') {\r\n\t\t\t\tdata.onComplete();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn Move;\r\n});\r\n"]}