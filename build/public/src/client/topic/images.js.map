{"version":3,"sources":["public/src/client/topic/images.js"],"names":["define","Images","wrapImagesInLinks","posts","find","each","$this","$","this","src","attr","alt","suffixRegex","utils","isRelativeUrl","test","replace","srcExt","split","slice","pop","altFilename","altExt","parent","is","wrap"],"mappings":"AAAA,aAGAA,OAAO,wBAA0B,WAChC,IAAIC,KAEJA,EAAOC,kBAAoB,SAAUC,GACpCA,EAAMC,KAAK,8CAA8CC,KAAK,WAC7D,IAAIC,EAAQC,EAAEC,MACd,IAAIC,EAAMH,EAAMI,KAAK,QAAU,GAC/B,IAAIC,EAAML,EAAMI,KAAK,QAAU,GAC/B,IAAIE,EAAc,sBAElB,GAAIH,IAAQ,cAAe,CAC1B,OAGD,GAAII,MAAMC,cAAcL,IAAQG,EAAYG,KAAKN,GAAM,CACtDA,EAAMA,EAAIO,QAAQJ,EAAa,MAEhC,IAAIK,EAASR,EAAIS,MAAM,KAAKC,MAAM,GAAGC,MACrC,IAAIC,EAAcV,EAAIO,MAAM,KAAKE,MACjC,IAAIE,EAASD,EAAYH,MAAM,KAAKC,MAAM,GAAGC,MAE7C,IAAKd,EAAMiB,SAASC,GAAG,KAAM,CAC5BlB,EAAMmB,KAAK,YAAchB,EAAM,OAC5BQ,GAAUK,EAAS,cAAgBD,EAAc,KAAO,IAC1D,wCAKJ,OAAOpB","file":"public/src/client/topic/images.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/topic/images', [], function () {\r\n\tvar Images = {};\r\n\r\n\tImages.wrapImagesInLinks = function (posts) {\r\n\t\tposts.find('[component=\"post/content\"] img:not(.emoji)').each(function () {\r\n\t\t\tvar $this = $(this);\r\n\t\t\tvar src = $this.attr('src') || '';\r\n\t\t\tvar alt = $this.attr('alt') || '';\r\n\t\t\tvar suffixRegex = /-resized(\\.[\\w]+)?$/;\r\n\r\n\t\t\tif (src === 'about:blank') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (utils.isRelativeUrl(src) && suffixRegex.test(src)) {\r\n\t\t\t\tsrc = src.replace(suffixRegex, '$1');\r\n\t\t\t}\r\n\t\t\tvar srcExt = src.split('.').slice(1).pop();\r\n\t\t\tvar altFilename = alt.split('/').pop();\r\n\t\t\tvar altExt = altFilename.split('.').slice(1).pop();\r\n\r\n\t\t\tif (!$this.parent().is('a')) {\r\n\t\t\t\t$this.wrap('<a href=\"' + src + '\" ' +\r\n\t\t\t\t\t(!srcExt && altExt ? ' download=\"' + altFilename + '\" ' : '') +\r\n\t\t\t\t\t' target=\"_blank\" rel=\"noopener\">');\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\treturn Images;\r\n});\r\n"]}