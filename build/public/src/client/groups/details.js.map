{"version":3,"sources":["public/src/client/groups/details.js"],"names":["define","memberList","iconSelect","components","coverPhoto","pictureCropper","translator","api","slugify","categorySelector","Details","groupName","init","detailsPage","get","ajaxify","data","group","name","isOwner","prepareSettings","imageData","position","callback","socket","emit","show","title","socketMethod","aspectRatio","NaN","allowSkippingCrop","restrictImageDimension","paramName","paramValue","imageUrlOnServer","startsWith","config","relative_path","Date","now","css","removeCover","handleMemberInvitations","find","addClass","on","btnEl","$","this","userRow","parents","ownerFlagEl","hasClass","uid","attr","action","slug","then","toggleClass","catch","app","alertError","translate","translated","bootbox","confirm","del","undefined","slideUp","remove","update","deleteGroup","put","user","refresh","toUid","err","message","settingsFormEl","labelColorValueEl","textColorValueEl","iconBtn","previewEl","previewElText","previewIcon","userTitleEl","userTitleEnabledEl","iconValueEl","val","translateText","value","customOpts","checked","removeAttr","removeClass","cidSelector","onSelect","selectedCategory","cids","split","map","cid","parseInt","push","filter","index","array","indexOf","join","selectCategory","checkboxes","length","settings","serializeObject","Array","isArray","memberPostCids","each","idx","inputEl","prop","pathname","window","location","substr","lastIndexOf","go","alertSuccess","utils","escapeHTML","prompt","response","searchInput","require","autocomplete","event","selected","item","usernames"],"mappings":"AAAA,aAEAA,OAAO,wBACN,0BACA,aACA,aACA,aACA,iBACA,aACA,MACA,UACA,oBACE,SACFC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,IAAIC,KACJ,IAAIC,EAEJD,EAAQE,KAAO,WACd,IAAIC,EAAcV,EAAWW,IAAI,oBAEjCH,EAAYI,QAAQC,KAAKC,MAAMC,KAE/B,GAAIH,QAAQC,KAAKC,MAAME,QAAS,CAC/BT,EAAQU,kBAERhB,EAAWQ,KACVT,EAAWW,IAAI,gBACf,SAAUO,EAAWC,EAAUC,GAC9BC,OAAOC,KAAK,uBACXd,UAAWA,EACXU,UAAWA,EACXC,SAAUA,GACRC,IAEJ,WACClB,EAAeqB,MACdC,MAAO,gCACPC,aAAc,sBACdC,YAAaC,IACbC,kBAAmB,KACnBC,uBAAwB,MACxBC,UAAW,YACXC,WAAYvB,GACV,SAAUwB,GACZA,IAAqBA,EAAiBC,WAAW,QAAUC,OAAOC,cAAgB,IAAMH,EAAmB,IAAMI,KAAKC,MACtHrC,EAAWW,IAAI,gBAAgB2B,IAAI,mBAAoB,OAASN,EAAmB,QAGrFO,GAIFzC,EAAWW,OAEX+B,IAEAxC,EAAWW,IAAI,mBAAmB8B,KAAK,qCAAqCC,SAAS,kBAErFhC,EAAYiC,GAAG,QAAS,gBAAiB,WACxC,IAAIC,EAAQC,EAAEC,MACd,IAAIC,EAAUH,EAAMI,QAAQ,cAC5B,IAAIC,EAAcF,EAAQN,KAAK,oBAC/B,IAAIzB,GAAWiC,EAAYC,SAAS,aACpC,IAAIC,EAAMJ,EAAQK,KAAK,YACvB,IAAIC,EAAST,EAAMQ,KAAK,eAExB,OAAQC,GACP,IAAK,kBACJjD,EAAIY,EAAU,MAAQ,kBAAkBJ,QAAQC,KAAKC,MAAMwC,kBAAkBH,QAAWI,KAAK,KAC5FN,EAAYO,YAAY,eACtBC,MAAMC,IAAIC,YACb,MAED,IAAK,OACJxD,EAAWyD,UAAU,kCAAmC,SAAUC,GACjEC,QAAQC,QAAQF,EAAY,SAAUE,GACrC,IAAKA,EAAS,CACb,OAGD3D,EAAI4D,eAAepD,QAAQC,KAAKC,MAAMwC,mBAAmBH,IAAOc,WAAWV,KAAK,IAAMR,EAAQmB,UAAUC,UAAUV,MAAMC,IAAIC,gBAG9H,MAED,IAAK,SACJpD,EAAQ6D,SACR,MAED,IAAK,SACJ7D,EAAQ8D,cACR,MAED,IAAK,OACJjE,EAAIkE,IAAI,WAAa1D,QAAQC,KAAKC,MAAMwC,KAAO,gBAAkBH,GAAOO,IAAIa,KAAKpB,KAAMc,WAAWV,KAAK,IAAM3C,QAAQ4D,WAAWf,MAAMC,IAAIC,YAC1I,MAED,IAAK,QACJvD,EAAI4D,IAAI,WAAapD,QAAQC,KAAKC,MAAMwC,KAAO,gBAAkBH,GAAOO,IAAIa,KAAKpB,KAAMc,WAAWV,KAAK,IAAM3C,QAAQ4D,WAAWf,MAAMC,IAAIC,YAC1I,MAGD,IAAK,SACL,IAAK,SACL,IAAK,cACL,IAAK,gBACL,IAAK,eACL,IAAK,eACL,IAAK,YACL,IAAK,YACJtC,OAAOC,KAAK,UAAY+B,GACvBoB,MAAOtB,EACP3C,UAAWA,GACT,SAAUkE,GACZ,IAAKA,EAAK,CACT9D,QAAQ4D,cACF,CACNd,IAAIC,WAAWe,EAAIC,YAGrB,UAKJpE,EAAQU,gBAAkB,WACzB,IAAI2D,EAAiB5E,EAAWW,IAAI,mBACpC,IAAIkE,EAAoBD,EAAenC,KAAK,uBAC5C,IAAIqC,EAAmBF,EAAenC,KAAK,sBAC3C,IAAIsC,EAAUH,EAAenC,KAAK,+BAClC,IAAIuC,EAAYJ,EAAenC,KAAK,UACpC,IAAIwC,EAAgBL,EAAenC,KAAK,eACxC,IAAIyC,EAAcF,EAAUvC,KAAK,KACjC,IAAI0C,EAAcP,EAAenC,KAAK,sBACtC,IAAI2C,EAAqBR,EAAenC,KAAK,6BAC7C,IAAI4C,EAAcT,EAAenC,KAAK,iBAEtCoC,EAAkBlC,GAAG,QAAS,WAC7BqC,EAAU1C,IAAI,mBAAoBuC,EAAkBS,SAGrDR,EAAiBnC,GAAG,QAAS,WAC5BqC,EAAU1C,IAAI,QAASwC,EAAiBQ,SAIzCP,EAAQpC,GAAG,QAAS,WACnB5C,EAAWU,KAAKyE,EAAa,WAC5BG,EAAYC,IAAIJ,EAAYI,WAK9BH,EAAYxC,GAAG,QAAS,WACvBsC,EAAcM,cAAezC,KAAK0C,OAASZ,EAAenC,KAAK,SAAS6C,SAIzEF,EAAmBzC,GAAG,SAAU,WAC/B,IAAI8C,EAAazF,EAAWW,IAAI,0BAEhC,GAAImC,KAAK4C,QAAS,CACjBD,EAAWE,WAAW,YACtBX,EAAUY,YAAY,YAChB,CACNH,EAAWrC,KAAK,WAAY,YAC5B4B,EAAUtC,SAAS,WAIrB,IAAImD,EAAcvF,EAAiBG,KAAKoC,EAAE,+DACzCiD,SAAU,SAAUC,GACnB,IAAIC,GAAQnD,EAAE,mBAAmByC,OAAS,IAAIW,MAAM,KAAKC,IAAIC,GAAOC,SAASD,EAAK,KAClFH,EAAKK,KAAKN,EAAiBI,KAC3BH,EAAOA,EAAKM,OAAO,CAACH,EAAKI,EAAOC,IAAUA,EAAMC,QAAQN,KAASI,GACjE1D,EAAE,mBAAmByC,IAAIU,EAAKU,KAAK,MACnCb,EAAYc,eAAe,OAK9BpG,EAAQ6D,OAAS,WAChB,IAAIQ,EAAiB5E,EAAWW,IAAI,mBACpC,IAAIiG,EAAahC,EAAenC,KAAK,gCAErC,GAAImC,EAAeiC,OAAQ,CAC1B,IAAIC,EAAWlC,EAAemC,kBAG9B,IAAKC,MAAMC,QAAQH,EAASI,gBAAiB,CAC5CJ,EAASI,eAAiBrE,EAAE,mBAAmByC,MAIhDsB,EAAWO,KAAK,SAAUC,EAAKC,GAC9BA,EAAUxE,EAAEwE,GACZ,GAAIA,EAAQR,OAAQ,CACnBC,EAASO,EAAQjE,KAAK,SAAWiE,EAAQC,KAAK,cAIhDlH,EAAIkE,eAAe1D,QAAQC,KAAKC,MAAMwC,OAAQwD,GAAUvD,KAAK,KAC5D,GAAIuD,EAAS/F,KAAM,CAClB,IAAIwG,EAAWC,OAAOC,SAASF,SAC/BA,EAAWA,EAASG,OAAO,EAAGH,EAASI,YAAY,MACnD/G,QAAQgH,GAAGL,EAAWlH,EAAQyG,EAAS/F,WACjC,CACNH,QAAQ4D,UAGTd,IAAImE,aAAa,8BACfpE,MAAMC,IAAIC,cAIfpD,EAAQ8D,YAAc,WACrBP,QAAQC,QAAQ,8CAAgD+D,MAAMC,WAAWvH,GAAY,SAAUuD,GACtG,GAAIA,EAAS,CACZD,QAAQkE,OAAO,6DAA8D,SAAUC,GACtF,GAAIA,IAAazH,EAAW,CAC3BJ,EAAI4D,eAAepD,QAAQC,KAAKC,MAAMwC,WAAYC,KAAK,KACtDG,IAAImE,aAAa,2BAA6BC,MAAMC,WAAWvH,GAAa,MAC5EI,QAAQgH,GAAG,YACTnE,MAAMC,IAAIC,mBAOlB,SAASnB,IACR,IAAK5B,QAAQC,KAAKC,MAAME,QAAS,CAChC,OAGD,IAAIkH,EAAcrF,EAAE,uCACpBsF,SAAS,gBAAiB,SAAUC,GACnCA,EAAa7D,KAAK2D,EAAa,SAAUG,EAAOC,GAC/CjH,OAAOC,KAAK,sBACXmD,MAAO6D,EAASC,KAAKhE,KAAKpB,IAC1B3C,UAAWI,QAAQC,KAAKC,MAAMC,MAC5B,SAAU2D,GACZ,GAAIA,EAAK,CACR,OAAOhB,IAAIC,WAAWe,EAAIC,SAE3B/D,QAAQ4D,gBAKX3B,EAAE,mDAAmDF,GAAG,QAAS,WAChE,IAAI6F,EAAY3F,EAAE,4CAA4CyC,MAC9D,IAAKkD,EAAW,CACf,OAAO,MAERnH,OAAOC,KAAK,0BACXkH,UAAWA,EACXhI,UAAWI,QAAQC,KAAKC,MAAMC,MAC5B,SAAU2D,GACZ,GAAIA,EAAK,CACR,OAAOhB,IAAIC,WAAWe,EAAIC,SAE3B/D,QAAQ4D,YAET,OAAO,QAIT,SAASjC,IACRpC,EAAWyD,UAAU,wCAAyC,SAAUC,GACvEC,QAAQC,QAAQF,EAAY,SAAUE,GACrC,IAAKA,EAAS,CACb,OAGD1C,OAAOC,KAAK,uBACXd,UAAWI,QAAQC,KAAKC,MAAMC,MAC5B,SAAU2D,GACZ,IAAKA,EAAK,CACT9D,QAAQ4D,cACF,CACNd,IAAIC,WAAWe,EAAIC,gBAOxB,OAAOpE","file":"public/src/client/groups/details.js","sourcesContent":["'use strict';\r\n\r\ndefine('forum/groups/details', [\r\n\t'forum/groups/memberlist',\r\n\t'iconSelect',\r\n\t'components',\r\n\t'coverPhoto',\r\n\t'pictureCropper',\r\n\t'translator',\r\n\t'api',\r\n\t'slugify',\r\n\t'categorySelector',\r\n], function (\r\n\tmemberList,\r\n\ticonSelect,\r\n\tcomponents,\r\n\tcoverPhoto,\r\n\tpictureCropper,\r\n\ttranslator,\r\n\tapi,\r\n\tslugify,\r\n\tcategorySelector\r\n) {\r\n\tvar Details = {};\r\n\tvar groupName;\r\n\r\n\tDetails.init = function () {\r\n\t\tvar detailsPage = components.get('groups/container');\r\n\r\n\t\tgroupName = ajaxify.data.group.name;\r\n\r\n\t\tif (ajaxify.data.group.isOwner) {\r\n\t\t\tDetails.prepareSettings();\r\n\r\n\t\t\tcoverPhoto.init(\r\n\t\t\t\tcomponents.get('groups/cover'),\r\n\t\t\t\tfunction (imageData, position, callback) {\r\n\t\t\t\t\tsocket.emit('groups.cover.update', {\r\n\t\t\t\t\t\tgroupName: groupName,\r\n\t\t\t\t\t\timageData: imageData,\r\n\t\t\t\t\t\tposition: position,\r\n\t\t\t\t\t}, callback);\r\n\t\t\t\t},\r\n\t\t\t\tfunction () {\r\n\t\t\t\t\tpictureCropper.show({\r\n\t\t\t\t\t\ttitle: '[[groups:upload-group-cover]]',\r\n\t\t\t\t\t\tsocketMethod: 'groups.cover.update',\r\n\t\t\t\t\t\taspectRatio: NaN,\r\n\t\t\t\t\t\tallowSkippingCrop: true,\r\n\t\t\t\t\t\trestrictImageDimension: false,\r\n\t\t\t\t\t\tparamName: 'groupName',\r\n\t\t\t\t\t\tparamValue: groupName,\r\n\t\t\t\t\t}, function (imageUrlOnServer) {\r\n\t\t\t\t\t\timageUrlOnServer = (!imageUrlOnServer.startsWith('http') ? config.relative_path : '') + imageUrlOnServer + '?' + Date.now();\r\n\t\t\t\t\t\tcomponents.get('groups/cover').css('background-image', 'url(' + imageUrlOnServer + ')');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tremoveCover\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tmemberList.init();\r\n\r\n\t\thandleMemberInvitations();\r\n\r\n\t\tcomponents.get('groups/activity').find('.content img:not(.not-responsive)').addClass('img-responsive');\r\n\r\n\t\tdetailsPage.on('click', '[data-action]', function () {\r\n\t\t\tvar btnEl = $(this);\r\n\t\t\tvar userRow = btnEl.parents('[data-uid]');\r\n\t\t\tvar ownerFlagEl = userRow.find('.member-name > i');\r\n\t\t\tvar isOwner = !ownerFlagEl.hasClass('invisible');\r\n\t\t\tvar uid = userRow.attr('data-uid');\r\n\t\t\tvar action = btnEl.attr('data-action');\r\n\r\n\t\t\tswitch (action) {\r\n\t\t\t\tcase 'toggleOwnership':\r\n\t\t\t\t\tapi[isOwner ? 'del' : 'put'](`/groups/${ajaxify.data.group.slug}/ownership/${uid}`, {}).then(() => {\r\n\t\t\t\t\t\townerFlagEl.toggleClass('invisible');\r\n\t\t\t\t\t}).catch(app.alertError);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'kick':\r\n\t\t\t\t\ttranslator.translate('[[groups:details.kick_confirm]]', function (translated) {\r\n\t\t\t\t\t\tbootbox.confirm(translated, function (confirm) {\r\n\t\t\t\t\t\t\tif (!confirm) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tapi.del(`/groups/${ajaxify.data.group.slug}/membership/${uid}`, undefined).then(() => userRow.slideUp().remove()).catch(app.alertError);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'update':\r\n\t\t\t\t\tDetails.update();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'delete':\r\n\t\t\t\t\tDetails.deleteGroup();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'join':\t// intentional fall-throughs!\r\n\t\t\t\t\tapi.put('/groups/' + ajaxify.data.group.slug + '/membership/' + (uid || app.user.uid), undefined).then(() => ajaxify.refresh()).catch(app.alertError);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'leave':\r\n\t\t\t\t\tapi.del('/groups/' + ajaxify.data.group.slug + '/membership/' + (uid || app.user.uid), undefined).then(() => ajaxify.refresh()).catch(app.alertError);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// TODO (14/10/2020): rewrite these to use api module and merge with above 2 case blocks\r\n\t\t\t\tcase 'accept':\t// intentional fall-throughs!\r\n\t\t\t\tcase 'reject':\r\n\t\t\t\tcase 'issueInvite':\r\n\t\t\t\tcase 'rescindInvite':\r\n\t\t\t\tcase 'acceptInvite':\r\n\t\t\t\tcase 'rejectInvite':\r\n\t\t\t\tcase 'acceptAll':\r\n\t\t\t\tcase 'rejectAll':\r\n\t\t\t\t\tsocket.emit('groups.' + action, {\r\n\t\t\t\t\t\ttoUid: uid,\r\n\t\t\t\t\t\tgroupName: groupName,\r\n\t\t\t\t\t}, function (err) {\r\n\t\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\t\tajaxify.refresh();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tapp.alertError(err.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tDetails.prepareSettings = function () {\r\n\t\tvar settingsFormEl = components.get('groups/settings');\r\n\t\tvar labelColorValueEl = settingsFormEl.find('[name=\"labelColor\"]');\r\n\t\tvar textColorValueEl = settingsFormEl.find('[name=\"textColor\"]');\r\n\t\tvar iconBtn = settingsFormEl.find('[data-action=\"icon-select\"]');\r\n\t\tvar previewEl = settingsFormEl.find('.label');\r\n\t\tvar previewElText = settingsFormEl.find('.label-text');\r\n\t\tvar previewIcon = previewEl.find('i');\r\n\t\tvar userTitleEl = settingsFormEl.find('[name=\"userTitle\"]');\r\n\t\tvar userTitleEnabledEl = settingsFormEl.find('[name=\"userTitleEnabled\"]');\r\n\t\tvar iconValueEl = settingsFormEl.find('[name=\"icon\"]');\r\n\r\n\t\tlabelColorValueEl.on('input', function () {\r\n\t\t\tpreviewEl.css('background-color', labelColorValueEl.val());\r\n\t\t});\r\n\r\n\t\ttextColorValueEl.on('input', function () {\r\n\t\t\tpreviewEl.css('color', textColorValueEl.val());\r\n\t\t});\r\n\r\n\t\t// Add icon selection interface\r\n\t\ticonBtn.on('click', function () {\r\n\t\t\ticonSelect.init(previewIcon, function () {\r\n\t\t\t\ticonValueEl.val(previewIcon.val());\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// If the user title changes, update that too\r\n\t\tuserTitleEl.on('keyup', function () {\r\n\t\t\tpreviewElText.translateText((this.value || settingsFormEl.find('#name').val()));\r\n\t\t});\r\n\r\n\t\t// Disable user title customisation options if the the user title itself is disabled\r\n\t\tuserTitleEnabledEl.on('change', function () {\r\n\t\t\tvar customOpts = components.get('groups/userTitleOption');\r\n\r\n\t\t\tif (this.checked) {\r\n\t\t\t\tcustomOpts.removeAttr('disabled');\r\n\t\t\t\tpreviewEl.removeClass('hide');\r\n\t\t\t} else {\r\n\t\t\t\tcustomOpts.attr('disabled', 'disabled');\r\n\t\t\t\tpreviewEl.addClass('hide');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar cidSelector = categorySelector.init($('.member-post-cids-selector [component=\"category-selector\"]'), {\r\n\t\t\tonSelect: function (selectedCategory) {\r\n\t\t\t\tvar cids = ($('#memberPostCids').val() || '').split(',').map(cid => parseInt(cid, 10));\r\n\t\t\t\tcids.push(selectedCategory.cid);\r\n\t\t\t\tcids = cids.filter((cid, index, array) => array.indexOf(cid) === index);\r\n\t\t\t\t$('#memberPostCids').val(cids.join(','));\r\n\t\t\t\tcidSelector.selectCategory(0);\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\tDetails.update = function () {\r\n\t\tvar settingsFormEl = components.get('groups/settings');\r\n\t\tvar checkboxes = settingsFormEl.find('input[type=\"checkbox\"][name]');\r\n\r\n\t\tif (settingsFormEl.length) {\r\n\t\t\tvar settings = settingsFormEl.serializeObject();\r\n\r\n\t\t\t// serializeObject doesnt return array for multi selects if only one item is selected\r\n\t\t\tif (!Array.isArray(settings.memberPostCids)) {\r\n\t\t\t\tsettings.memberPostCids = $('#memberPostCids').val();\r\n\t\t\t}\r\n\r\n\t\t\t// Fix checkbox values\r\n\t\t\tcheckboxes.each(function (idx, inputEl) {\r\n\t\t\t\tinputEl = $(inputEl);\r\n\t\t\t\tif (inputEl.length) {\r\n\t\t\t\t\tsettings[inputEl.attr('name')] = inputEl.prop('checked');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tapi.put(`/groups/${ajaxify.data.group.slug}`, settings).then(() => {\r\n\t\t\t\tif (settings.name) {\r\n\t\t\t\t\tvar pathname = window.location.pathname;\r\n\t\t\t\t\tpathname = pathname.substr(1, pathname.lastIndexOf('/'));\r\n\t\t\t\t\tajaxify.go(pathname + slugify(settings.name));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tajaxify.refresh();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tapp.alertSuccess('[[groups:event.updated]]');\r\n\t\t\t}).catch(app.alertError);\r\n\t\t}\r\n\t};\r\n\r\n\tDetails.deleteGroup = function () {\r\n\t\tbootbox.confirm('Are you sure you want to delete the group: ' + utils.escapeHTML(groupName), function (confirm) {\r\n\t\t\tif (confirm) {\r\n\t\t\t\tbootbox.prompt('Please enter the name of this group in order to delete it:', function (response) {\r\n\t\t\t\t\tif (response === groupName) {\r\n\t\t\t\t\t\tapi.del(`/groups/${ajaxify.data.group.slug}`, {}).then(() => {\r\n\t\t\t\t\t\t\tapp.alertSuccess('[[groups:event.deleted, ' + utils.escapeHTML(groupName) + ']]');\r\n\t\t\t\t\t\t\tajaxify.go('groups');\r\n\t\t\t\t\t\t}).catch(app.alertError);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tfunction handleMemberInvitations() {\r\n\t\tif (!ajaxify.data.group.isOwner) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar searchInput = $('[component=\"groups/members/invite\"]');\r\n\t\trequire(['autocomplete'], function (autocomplete) {\r\n\t\t\tautocomplete.user(searchInput, function (event, selected) {\r\n\t\t\t\tsocket.emit('groups.issueInvite', {\r\n\t\t\t\t\ttoUid: selected.item.user.uid,\r\n\t\t\t\t\tgroupName: ajaxify.data.group.name,\r\n\t\t\t\t}, function (err) {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tajaxify.refresh();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t$('[component=\"groups/members/bulk-invite-button\"]').on('click', function () {\r\n\t\t\tvar usernames = $('[component=\"groups/members/bulk-invite\"]').val();\r\n\t\t\tif (!usernames) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tsocket.emit('groups.issueMassInvite', {\r\n\t\t\t\tusernames: usernames,\r\n\t\t\t\tgroupName: ajaxify.data.group.name,\r\n\t\t\t}, function (err) {\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t}\r\n\t\t\t\tajaxify.refresh();\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction removeCover() {\r\n\t\ttranslator.translate('[[groups:remove_group_cover_confirm]]', function (translated) {\r\n\t\t\tbootbox.confirm(translated, function (confirm) {\r\n\t\t\t\tif (!confirm) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsocket.emit('groups.cover.remove', {\r\n\t\t\t\t\tgroupName: ajaxify.data.group.name,\r\n\t\t\t\t}, function (err) {\r\n\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\tajaxify.refresh();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tapp.alertError(err.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\treturn Details;\r\n});\r\n"]}