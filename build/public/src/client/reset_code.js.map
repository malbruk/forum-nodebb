{"version":3,"sources":["public/src/client/reset_code.js"],"names":["define","zxcvbn","ResetCode","init","reset_code","ajaxify","data","code","resetEl","$","password","repeat","on","strength","val","length","minimumPasswordLength","removeClass","translateText","score","minimumPasswordStrength","prop","translateHtml","socket","emit","err","refresh","app","alertError","message","window","location","href","config","relative_path"],"mappings":"AAAA,aAGAA,OAAO,oBAAqB,UAAW,SAAUC,GAChD,IAAIC,KAEJA,EAAUC,KAAO,WAChB,IAAIC,EAAaC,QAAQC,KAAKC,KAE9B,IAAIC,EAAUC,EAAE,UAChB,IAAIC,EAAWD,EAAE,aACjB,IAAIE,EAASF,EAAE,WAEfD,EAAQI,GAAG,QAAS,WACnB,IAAIC,EAAWZ,EAAOS,EAASI,OAC/B,GAAIJ,EAASI,MAAMC,OAASV,QAAQC,KAAKU,sBAAuB,CAC/DP,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,8CAC5B,GAAIR,EAASI,MAAMC,OAAS,IAAK,CACvCN,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,oCAC5B,GAAIR,EAASI,QAAUH,EAAOG,MAAO,CAC3CL,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,kDAC5B,GAAIL,EAASM,MAAQd,QAAQC,KAAKc,wBAAyB,CACjEX,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,8BAC5B,CACNV,EAAQa,KAAK,WAAY,MAAMC,cAAc,8EAC7CC,OAAOC,KAAK,qBACXjB,KAAMH,EACNM,SAAUA,EAASI,OACjB,SAAUW,GACZ,GAAIA,EAAK,CACRpB,QAAQqB,UACR,OAAOC,IAAIC,WAAWH,EAAII,SAG3BC,OAAOC,SAASC,KAAOC,OAAOC,cAAgB,WAGhD,OAAO,SAIT,OAAOhC","file":"public/src/client/reset_code.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/reset_code', ['zxcvbn'], function (zxcvbn) {\r\n\tvar ResetCode = {};\r\n\r\n\tResetCode.init = function () {\r\n\t\tvar reset_code = ajaxify.data.code;\r\n\r\n\t\tvar resetEl = $('#reset');\r\n\t\tvar password = $('#password');\r\n\t\tvar repeat = $('#repeat');\r\n\r\n\t\tresetEl.on('click', function () {\r\n\t\t\tvar strength = zxcvbn(password.val());\r\n\t\t\tif (password.val().length < ajaxify.data.minimumPasswordLength) {\r\n\t\t\t\t$('#notice').removeClass('hidden');\r\n\t\t\t\t$('#notice strong').translateText('[[reset_password:password_too_short]]');\r\n\t\t\t} else if (password.val().length > 512) {\r\n\t\t\t\t$('#notice').removeClass('hidden');\r\n\t\t\t\t$('#notice strong').translateText('[[error:password-too-long]]');\r\n\t\t\t} else if (password.val() !== repeat.val()) {\r\n\t\t\t\t$('#notice').removeClass('hidden');\r\n\t\t\t\t$('#notice strong').translateText('[[reset_password:passwords_do_not_match]]');\r\n\t\t\t} else if (strength.score < ajaxify.data.minimumPasswordStrength) {\r\n\t\t\t\t$('#notice').removeClass('hidden');\r\n\t\t\t\t$('#notice strong').translateText('[[user:weak_password]]');\r\n\t\t\t} else {\r\n\t\t\t\tresetEl.prop('disabled', true).translateHtml('<i class=\"fa fa-spin fa-refresh\"></i> [[reset_password:changing_password]]');\r\n\t\t\t\tsocket.emit('user.reset.commit', {\r\n\t\t\t\t\tcode: reset_code,\r\n\t\t\t\t\tpassword: password.val(),\r\n\t\t\t\t}, function (err) {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tajaxify.refresh();\r\n\t\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twindow.location.href = config.relative_path + '/login';\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t};\r\n\r\n\treturn ResetCode;\r\n});\r\n"]}