{"version":3,"sources":["public/src/client/account/posts.js"],"names":["define","header","infinitescroll","AccountPosts","template","page","init","$","addClass","handleInfiniteScroll","_template","ajaxify","data","pagination","currentPage","config","usePagination","loadMore","direction","params","utils","loadMoreXhr","done","posts","length","onPostsLoaded","callback","app","parseAndTranslate","html","append","find","timeago","createUserTooltips","makeNumbersHumanReadable","window","trigger"],"mappings":"AAAA,aAGAA,OAAO,uBAAwB,uBAAwB,wBAAyB,SAAUC,EAAQC,GACjG,IAAIC,KAEJ,IAAIC,EACJ,IAAIC,EAAO,EAEXF,EAAaG,KAAO,WACnBL,EAAOK,OAEPC,EAAE,uDAAuDC,SAAS,kBAElEL,EAAaM,qBAAqB,kBAGnCN,EAAaM,qBAAuB,SAAUC,GAC7CN,EAAWM,EACXL,EAAOM,QAAQC,KAAKC,WAAWC,YAC/B,IAAKC,OAAOC,cAAe,CAC1Bd,EAAeI,KAAKW,KAItB,SAASA,EAASC,GACjB,GAAIA,EAAY,EAAG,CAClB,OAED,IAAIC,EAASC,MAAMD,SACnBd,GAAQ,EACRc,EAAOd,KAAOA,EAEdH,EAAemB,YAAYF,EAAQ,SAAUP,EAAMU,GAClD,GAAIV,EAAKW,OAASX,EAAKW,MAAMC,OAAQ,CACpCC,EAAcb,EAAKW,MAAOD,OACpB,CACNA,OAKH,SAASG,EAAcF,EAAOG,GAC7BC,IAAIC,kBAAkBxB,EAAU,SAAWmB,MAAOA,GAAS,SAAUM,GACpEtB,EAAE,uBAAuBuB,OAAOD,GAChCA,EAAKE,KAAK,4BAA4BvB,SAAS,kBAC/CqB,EAAKE,KAAK,YAAYC,UACtBL,IAAIM,qBACJb,MAAMc,yBAAyBL,EAAKE,KAAK,2BACzCxB,EAAE4B,QAAQC,QAAQ,uBAAyBb,MAAOA,IAClDG,MAIF,OAAOvB","file":"public/src/client/account/posts.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/account/posts', ['forum/account/header', 'forum/infinitescroll'], function (header, infinitescroll) {\r\n\tvar AccountPosts = {};\r\n\r\n\tvar template;\r\n\tvar page = 1;\r\n\r\n\tAccountPosts.init = function () {\r\n\t\theader.init();\r\n\r\n\t\t$('[component=\"post/content\"] img:not(.not-responsive)').addClass('img-responsive');\r\n\r\n\t\tAccountPosts.handleInfiniteScroll('account/posts');\r\n\t};\r\n\r\n\tAccountPosts.handleInfiniteScroll = function (_template) {\r\n\t\ttemplate = _template;\r\n\t\tpage = ajaxify.data.pagination.currentPage;\r\n\t\tif (!config.usePagination) {\r\n\t\t\tinfinitescroll.init(loadMore);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction loadMore(direction) {\r\n\t\tif (direction < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar params = utils.params();\r\n\t\tpage += 1;\r\n\t\tparams.page = page;\r\n\r\n\t\tinfinitescroll.loadMoreXhr(params, function (data, done) {\r\n\t\t\tif (data.posts && data.posts.length) {\r\n\t\t\t\tonPostsLoaded(data.posts, done);\r\n\t\t\t} else {\r\n\t\t\t\tdone();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction onPostsLoaded(posts, callback) {\r\n\t\tapp.parseAndTranslate(template, 'posts', { posts: posts }, function (html) {\r\n\t\t\t$('[component=\"posts\"]').append(html);\r\n\t\t\thtml.find('img:not(.not-responsive)').addClass('img-responsive');\r\n\t\t\thtml.find('.timeago').timeago();\r\n\t\t\tapp.createUserTooltips();\r\n\t\t\tutils.makeNumbersHumanReadable(html.find('.human-readable-number'));\r\n\t\t\t$(window).trigger('action:posts.loaded', { posts: posts });\r\n\t\t\tcallback();\r\n\t\t});\r\n\t}\r\n\r\n\treturn AccountPosts;\r\n});\r\n"]}