{"version":3,"sources":["public/src/client/header/chat.js"],"names":["define","components","chat","prepareDOM","chatsToggleEl","get","chatsListEl","on","parent","hasClass","requireAndCall","parents","socket","removeListener","onChatMessageReceived","onUserStatusChange","onRoomRename","count","toggleClass","attr","data","method","param","require"],"mappings":"AAAA,aAEAA,OAAO,qBAAsB,cAAe,SAAUC,GACrD,IAAIC,KAEJA,EAAKC,WAAa,WACjB,IAAIC,EAAgBH,EAAWI,IAAI,iBACnC,IAAIC,EAAcL,EAAWI,IAAI,aAEjCD,EAAcG,GAAG,QAAS,WACzB,GAAIH,EAAcI,SAASC,SAAS,QAAS,CAC5C,OAEDC,EAAe,oBAAqBJ,KAGrC,GAAIF,EAAcO,QAAQ,aAAaF,SAAS,QAAS,CACxDC,EAAe,oBAAqBJ,GAGrCM,OAAOC,eAAe,sBAAuBC,GAC7CF,OAAOL,GAAG,sBAAuBO,GAEjCF,OAAOC,eAAe,2BAA4BE,GAClDH,OAAOL,GAAG,2BAA4BQ,GAEtCH,OAAOC,eAAe,yBAA0BG,GAChDJ,OAAOL,GAAG,yBAA0BS,GAEpCJ,OAAOL,GAAG,+BAAgC,SAAUU,GACnDhB,EAAWI,IAAI,aACba,YAAY,eAAgBD,EAAQ,GACpCE,KAAK,eAAgBF,EAAQ,GAAK,MAAQA,MAI9C,SAASH,EAAsBM,GAC9BV,EAAe,wBAAyBU,GAGzC,SAASL,EAAmBK,GAC3BV,EAAe,qBAAsBU,GAGtC,SAASJ,EAAaI,GACrBV,EAAe,eAAgBU,GAGhC,SAASV,EAAeW,EAAQC,GAC/BC,SAAS,QAAS,SAAUrB,GAC3BA,EAAKmB,GAAQC,KAIf,OAAOpB","file":"public/src/client/header/chat.js","sourcesContent":["'use strict';\r\n\r\ndefine('forum/header/chat', ['components'], function (components) {\r\n\tvar chat = {};\r\n\r\n\tchat.prepareDOM = function () {\r\n\t\tvar chatsToggleEl = components.get('chat/dropdown');\r\n\t\tvar chatsListEl = components.get('chat/list');\r\n\r\n\t\tchatsToggleEl.on('click', function () {\r\n\t\t\tif (chatsToggleEl.parent().hasClass('open')) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\trequireAndCall('loadChatsDropdown', chatsListEl);\r\n\t\t});\r\n\r\n\t\tif (chatsToggleEl.parents('.dropdown').hasClass('open')) {\r\n\t\t\trequireAndCall('loadChatsDropdown', chatsListEl);\r\n\t\t}\r\n\r\n\t\tsocket.removeListener('event:chats.receive', onChatMessageReceived);\r\n\t\tsocket.on('event:chats.receive', onChatMessageReceived);\r\n\r\n\t\tsocket.removeListener('event:user_status_change', onUserStatusChange);\r\n\t\tsocket.on('event:user_status_change', onUserStatusChange);\r\n\r\n\t\tsocket.removeListener('event:chats.roomRename', onRoomRename);\r\n\t\tsocket.on('event:chats.roomRename', onRoomRename);\r\n\r\n\t\tsocket.on('event:unread.updateChatCount', function (count) {\r\n\t\t\tcomponents.get('chat/icon')\r\n\t\t\t\t.toggleClass('unread-count', count > 0)\r\n\t\t\t\t.attr('data-content', count > 99 ? '99+' : count);\r\n\t\t});\r\n\t};\r\n\r\n\tfunction onChatMessageReceived(data) {\r\n\t\trequireAndCall('onChatMessageReceived', data);\r\n\t}\r\n\r\n\tfunction onUserStatusChange(data) {\r\n\t\trequireAndCall('onUserStatusChange', data);\r\n\t}\r\n\r\n\tfunction onRoomRename(data) {\r\n\t\trequireAndCall('onRoomRename', data);\r\n\t}\r\n\r\n\tfunction requireAndCall(method, param) {\r\n\t\trequire(['chat'], function (chat) {\r\n\t\t\tchat[method](param);\r\n\t\t});\r\n\t}\r\n\r\n\treturn chat;\r\n});\r\n"]}