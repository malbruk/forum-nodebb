"use strict";define("forum/login",["jquery-form"],function(){var e={_capsState:false};e.init=function(){var t=$("#login-error-notify");var a=$("#login");var n=$("#login-form");a.on("click",function(e){e.preventDefault();if(!$("#username").val()||!$("#password").val()){t.find("p").translateText("[[error:invalid-username-or-password]]");t.show()}else{t.hide();if(a.hasClass("disabled")){return}a.addClass("disabled");$(window).trigger("action:app.login");n.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=true},success:function(e){$(window).trigger("action:app.loggedIn",e);var t=utils.urlToLocation(e.next).pathname;var a=utils.params({url:e.next});a.loggedin=true;var n=decodeURIComponent($.param(a));window.location.href=t+"?"+n},error:function(e){if(e.status===403&&e.responseText==="Forbidden"){window.location.href=config.relative_path+"/login?error=csrf-invalid"}else{t.find("p").translateText(e.responseText);t.show();a.removeClass("disabled");if($("#password:focus").length){$("#password").select()}}}})}});e.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning"));$("#login-error-notify button").on("click",function(e){e.preventDefault();t.hide();return false});if($("#content #username").val()){$("#content #password").val("").focus()}else{$("#content #username").focus()}$("#content #noscript").val("false")};e.capsLockCheck=((t,a)=>{const n=e=>{a.classList[e?"remove":"add"]("hidden");a.parentNode.classList[e?"add":"remove"]("has-warning")};if(!t){return}t.addEventListener("keyup",function(t){if(e._capsState&&t.key==="CapsLock"){n(false);e._capsState=!e._capsState;return}e._capsState=t.getModifierState&&t.getModifierState("CapsLock");n(e._capsState)});if(e._capsState){n(true)}});return e});
//# sourceMappingURL=login.js.map