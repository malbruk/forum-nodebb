{"version":3,"sources":["node_modules/nodebb-plugin-composer-default/static/lib/composer/formatting.js"],"names":["define","controls","preview","resize","uploader","topicThumbs","formatting","formattingDispatchTable","picture","postContainer","this","find","click","upload","thumbs","require","composer","uuid","get","getAttribute","composerObj","posts","action","isMain","modal","open","id","pid","then","trigger","updateThumbCount","tags","toggleClass","zen","$","window","one","onResize","screenfull","isFullscreen","app","toggleNavbar","removeClass","reposition","off","addClass","focus","on","exit","toggle","buttons","addComposerButtons","x","numButtons","length","before","name","title","iconClass","addButton","onClick","replace","push","getDispatchTable","addButtonDispatch","addHandler","event","format","attr","textarea","parents","hasOwnProperty","call","selectionStart","selectionEnd","render"],"mappings":"AAAA,aAIAA,OAAO,uBAAwB,oBAAqB,mBAAoB,kBAAmB,WAAY,eAAgB,SAASC,EAAUC,EAASC,EAAQC,EAAUC,GAEpK,IAAIC,KAEJ,IAAIC,GACHC,QAAS,WACR,IAAIC,EAAgBC,KACpBD,EAAcE,KAAK,UAAUC,SAG9BC,OAAQ,WACP,IAAIJ,EAAgBC,KACpBD,EAAcE,KAAK,UAAUC,SAG9BE,OAAQ,WACP,IAAIL,EAAgBC,KACpBK,SAAS,YAAa,SAAUC,GAC/B,MAAMC,EAAOR,EAAcS,IAAI,GAAGC,aAAa,aAC/C,MAAMC,EAAcJ,EAASK,MAAMJ,GAEnC,GAAIG,EAAYE,SAAW,eAAkBF,EAAYE,SAAW,cAAgBF,EAAYG,OAAS,CACxGlB,EAAYmB,MAAMC,MAAOC,GAAIT,EAAMU,IAAKP,EAAYO,MAAOC,KAAK,KAC/DnB,EAAcoB,QAAQ,kBAGtBb,EAASc,iBAAiBb,EAAMR,SAMpCsB,KAAM,WACL,IAAItB,EAAgBC,KACpBD,EAAcE,KAAK,mBAAmBqB,YAAY,WAGnDC,IAAK,WACJ,IAAIxB,EAAgBC,KACpBwB,EAAEC,QAAQC,IAAI,SAAU,WACvB,SAASC,IACR,IAAKC,WAAWC,aAAc,CAC7BC,IAAIC,aAAa,MACjBP,EAAE,QAAQQ,YAAY,YACtBvC,EAAOwC,WAAWlC,GAClByB,EAAEC,QAAQS,IAAI,SAAUP,IAI1B,GAAIC,WAAWC,aAAc,CAC5BC,IAAIC,aAAa,OACjBP,EAAE,QAAQW,SAAS,YACnBpC,EAAcE,KAAK,UAAUmC,QAE7BZ,EAAEC,QAAQY,GAAG,SAAUV,GACvBH,EAAEC,QAAQC,IAAI,6GAA8GE,WAAWU,SAIzIV,WAAWW,OAAOxC,EAAcS,IAAI,MAItC,IAAIgC,KAEJ5C,EAAW6C,mBAAqB,WAC/B,IAAI,IAAIC,EAAE,EAAEC,EAAWH,EAAQI,OAAOF,EAAEC,EAAWD,IAAK,CACvDlB,EAAE,+CAA+CqB,OAAO,kCAAoCL,EAAQE,GAAGI,KAAO,aAAeN,EAAQE,GAAGK,OAAS,IAAM,eAAiBP,EAAQE,GAAGM,UAAY,iBAIjMpD,EAAWqD,UAAY,SAASD,EAAWE,EAASH,EAAOD,GAC1D,IAAIA,EAAOA,GAAQE,EAAUG,QAAQ,SAAU,IAE/CtD,EAAwBiD,GAAQI,EAChCV,EAAQY,MACPN,KAAMA,EACNE,UAAWA,EACXD,MAAOA,KAITnD,EAAWyD,iBAAmB,WAC7B,OAAOxD,GAGRD,EAAW0D,kBAAoB,SAASR,EAAMI,GAC7CrD,EAAwBiD,GAAQI,GAGjCtD,EAAW2D,WAAa,SAASxD,GAChCA,EAAcsC,GAAG,QAAS,qBAAsB,SAAUmB,GACzD,IAAIC,EAASjC,EAAExB,MAAM0D,KAAK,eACzBC,EAAWnC,EAAExB,MAAM4D,QAAQ,0BAA0B3D,KAAK,YAAY,GAEvE,GAAGJ,EAAwBgE,eAAeJ,GAAQ,CACjD5D,EAAwB4D,GAAQK,KAAK/D,EAAe4D,EAAUA,EAASI,eAAgBJ,EAASK,aAAcR,GAC9GhE,EAAQyE,OAAOlE,OAKlB,OAAOH","file":"node_modules/nodebb-plugin-composer-default/static/lib/composer/formatting.js","sourcesContent":["'use strict';\n\n/* globals app, define, screenfull */\n\ndefine('composer/formatting', ['composer/controls', 'composer/preview', 'composer/resize', 'uploader', 'topicThumbs'], function(controls, preview, resize, uploader, topicThumbs) {\n\n\tvar formatting = {};\n\n\tvar formattingDispatchTable = {\n\t\tpicture: function () {\n\t\t\tvar postContainer = this;\n\t\t\tpostContainer.find('#files').click();\n\t\t},\n\n\t\tupload: function () {\n\t\t\tvar postContainer = this;\n\t\t\tpostContainer.find('#files').click();\n\t\t},\n\n\t\tthumbs: function () {\n\t\t\tvar postContainer = this;\n\t\t\trequire(['composer'], function (composer) {\n\t\t\t\tconst uuid = postContainer.get(0).getAttribute('data-uuid');\n\t\t\t\tconst composerObj = composer.posts[uuid];\n\n\t\t\t\tif (composerObj.action === 'topics.post' || (composerObj.action === 'posts.edit' && composerObj.isMain)) {\n\t\t\t\t\ttopicThumbs.modal.open({ id: uuid, pid: composerObj.pid }).then(() => {\n\t\t\t\t\t\tpostContainer.trigger('thumb.uploaded');\t// toggle draft save\n\n\t\t\t\t\t\t// Update client-side with count\n\t\t\t\t\t\tcomposer.updateThumbCount(uuid, postContainer);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\ttags: function() {\n\t\t\tvar postContainer = this;\n\t\t\tpostContainer.find('.tags-container').toggleClass('hidden');\n\t\t},\n\n\t\tzen: function() {\n\t\t\tvar postContainer = this;\n\t\t\t$(window).one('resize', function() {\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tif (!screenfull.isFullscreen) {\n\t\t\t\t\t\tapp.toggleNavbar(true);\n\t\t\t\t\t\t$('html').removeClass('zen-mode');\n\t\t\t\t\t\tresize.reposition(postContainer);\n\t\t\t\t\t\t$(window).off('resize', onResize);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (screenfull.isFullscreen) {\n\t\t\t\t\tapp.toggleNavbar(false);\n\t\t\t\t\t$('html').addClass('zen-mode');\n\t\t\t\t\tpostContainer.find('.write').focus();\n\n\t\t\t\t\t$(window).on('resize', onResize);\n\t\t\t\t\t$(window).one('action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard', screenfull.exit);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tscreenfull.toggle(postContainer.get(0));\n\t\t}\n\t};\n\n\tvar buttons = [];\n\n\tformatting.addComposerButtons = function() {\n\t\tfor(var x=0,numButtons=buttons.length;x<numButtons;x++) {\n\t\t\t$('.formatting-bar .formatting-group #fileForm').before('<li tabindex=\"-1\" data-format=\"' + buttons[x].name + '\" title=\"' + (buttons[x].title || '') + '\"><i class=\"' + buttons[x].iconClass + '\"></i></li>');\n\t\t}\n\t};\n\n\tformatting.addButton = function(iconClass, onClick, title, name) {\n\t\tvar name = name || iconClass.replace('fa fa-', '');\n\n\t\tformattingDispatchTable[name] = onClick;\n\t\tbuttons.push({\n\t\t\tname: name,\n\t\t\ticonClass: iconClass,\n\t\t\ttitle: title\n\t\t});\n\t};\n\n\tformatting.getDispatchTable = function () {\n\t\treturn formattingDispatchTable;\n\t};\n\n\tformatting.addButtonDispatch = function(name, onClick) {\n\t\tformattingDispatchTable[name] = onClick;\n\t};\n\n\tformatting.addHandler = function(postContainer) {\n\t\tpostContainer.on('click', '.formatting-bar li', function (event) {\n\t\t\tvar format = $(this).attr('data-format'),\n\t\t\t\ttextarea = $(this).parents('[component=\"composer\"]').find('textarea')[0];\n\n\t\t\tif(formattingDispatchTable.hasOwnProperty(format)){\n\t\t\t\tformattingDispatchTable[format].call(postContainer, textarea, textarea.selectionStart, textarea.selectionEnd, event);\n\t\t\t\tpreview.render(postContainer);\n\t\t\t}\n\t\t});\n\t};\n\n\treturn formatting;\n});\n"]}