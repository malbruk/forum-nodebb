"use strict";define("composer/categoryList",["categorySelector","taskbar","api"],function(e,t,a){var o={};var i;o.init=function(t,a){var c=t.find(".category-list-container");if(!c.length){return}t.on("action:composer.resize",function(){n(t)});o.updateTaskbar(t,a);i=e.init(c.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","notwatching","ignoring"],onSelect:function(e){if(a.hasOwnProperty("cid")){r(t,a,e)}}});if(!i){return}if(a.cid&&ajaxify.data.template.category&&parseInt(a.cid,10)===parseInt(ajaxify.data.cid,10)){i.selectedCategory={cid:a.cid,name:ajaxify.data.name}}else if(ajaxify.data.template.compose&&ajaxify.data.selectedCategory){i.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}}t.find(".category-name").translateText(i.selectedCategory?i.selectedCategory.name:"[[modules:composer.select_category]]").on("click",function(){e.modal({privilege:"topics:create",states:["watching","notwatching","ignoring"],openOnLoad:true,showLinks:false,onSelect:function(e){t.find(".category-name").text(e.name);i.selectCategory(e.cid);if(a.hasOwnProperty("cid")){r(t,a,e)}}})});n(t)};function n(e){e.find('.category-list-container [component="category-selector"]').toggleClass("dropup",e.outerHeight()<$(window).height()/2)}o.getSelectedCid=function(){var e;if(i){e=i.getSelectedCategory()}return e?e.cid:0};o.updateTaskbar=function(e,t){if(parseInt(t.cid,10)){a.get(`/categories/${t.cid}`,{}).then(function(t){c(e,t)})}};function c(e,a){if(a){var o=e.attr("data-uuid");t.update("composer",o,{image:a.backgroundImage,"background-color":a.bgColor,icon:a.icon&&a.icon.slice(3)})}}async function r(e,t,a){t.cid=a.cid;const o=await window.fetch(`${config.relative_path}/api/category/${a.cid}`).then(e=>e.json());c(e,o);require(["composer/scheduler","composer/tags"],function(i,n){i.onChangeCategory(o);n.onChangeCategory(e,t,a.cid,o);$(window).trigger("action:composer.changeCategory",{postContainer:e,postData:t,selectedCategory:a,categoryData:o})})}return o});
//# sourceMappingURL=categoryList.js.map