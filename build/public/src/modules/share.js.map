{"version":3,"sources":["public/src/modules/share.js"],"names":["define","module","addShareHandlers","name","baseUrl","window","location","protocol","host","openShare","url","urlToPost","width","height","open","encodeURIComponent","config","relative_path","$","trigger","off","on","postLink","this","find","val","getPostUrl","setTimeout","putCursorAtEnd","select","addHandler","e","preventDefault","selector","callback","clickedElement","pid","parseInt","parents","attr"],"mappings":"AAAA,aAGAA,OAAO,QAAS,WACf,IAAIC,KAEJA,EAAOC,iBAAmB,SAAUC,GACnC,IAAIC,EAAUC,OAAOC,SAASC,SAAW,KAAOF,OAAOC,SAASE,KAEhE,SAASC,EAAUC,EAAKC,EAAWC,EAAOC,GACzCR,OAAOS,KAAKJ,EAAMK,mBAAmBX,EAAUY,OAAOC,cAAgBN,GAAY,SAAU,SAAWC,EAAQ,WAAaC,EAAS,4BACrIK,EAAEb,QAAQc,QAAQ,qBACjBT,IAAKA,EACLC,UAAWA,IAEZ,OAAO,MAGRO,EAAE,YAAYE,IAAI,oBAAqB,mBAAmBC,GAAG,oBAAqB,kBAAmB,WACpG,IAAIC,EAAWJ,EAAEK,MAAMC,KAAK,cAC5BF,EAASG,IAAIrB,EAAUsB,EAAWR,EAAEK,QAGpCI,WAAW,WACVL,EAASM,iBAAiBC,UACxB,MAGJC,EAAW,aAAc,SAAUC,GAClCA,EAAEC,iBACF,OAAO,QAGRF,EAAW,8BAA+B,WACzC,OAAOrB,EAAU,yCAA2CM,mBAAmBZ,GAAQ,QAASuB,EAAWR,EAAEK,OAAQ,IAAK,OAG3HO,EAAW,+BAAgC,WAC1C,OAAOrB,EAAU,gDAAiDiB,EAAWR,EAAEK,OAAQ,IAAK,OAG7FO,EAAW,6BAA8B,WACxC,OAAOrB,EAAU,qCAAsCiB,EAAWR,EAAEK,OAAQ,IAAK,OAGlFL,EAAEb,QAAQc,QAAQ,4BAA8BV,UAAWA,KAG5D,SAASqB,EAAWG,EAAUC,GAC7BhB,EAAE,YAAYE,IAAI,QAASa,GAAUZ,GAAG,QAASY,EAAUC,GAG5D,SAASR,EAAWS,GACnB,IAAIC,EAAMC,SAASF,EAAeG,QAAQ,cAAcC,KAAK,YAAa,IAC1E,MAAO,SAAWH,EAAM,IAAM,EAAQ,IAGvC,OAAOnC","file":"public/src/modules/share.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('share', function () {\r\n\tvar module = {};\r\n\r\n\tmodule.addShareHandlers = function (name) {\r\n\t\tvar baseUrl = window.location.protocol + '//' + window.location.host;\r\n\r\n\t\tfunction openShare(url, urlToPost, width, height) {\r\n\t\t\twindow.open(url + encodeURIComponent(baseUrl + config.relative_path + urlToPost), '_blank', 'width=' + width + ',height=' + height + ',scrollbars=no,status=no');\r\n\t\t\t$(window).trigger('action:share.open', {\r\n\t\t\t\turl: url,\r\n\t\t\t\turlToPost: urlToPost,\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t$('#content').off('shown.bs.dropdown', '.share-dropdown').on('shown.bs.dropdown', '.share-dropdown', function () {\r\n\t\t\tvar postLink = $(this).find('.post-link');\r\n\t\t\tpostLink.val(baseUrl + getPostUrl($(this)));\r\n\r\n\t\t\t// without the setTimeout can't select the text in the input\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tpostLink.putCursorAtEnd().select();\r\n\t\t\t}, 50);\r\n\t\t});\r\n\r\n\t\taddHandler('.post-link', function (e) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\taddHandler('[component=\"share/twitter\"]', function () {\r\n\t\t\treturn openShare('https://twitter.com/intent/tweet?text=' + encodeURIComponent(name) + '&url=', getPostUrl($(this)), 550, 420);\r\n\t\t});\r\n\r\n\t\taddHandler('[component=\"share/facebook\"]', function () {\r\n\t\t\treturn openShare('https://www.facebook.com/sharer/sharer.php?u=', getPostUrl($(this)), 626, 436);\r\n\t\t});\r\n\r\n\t\taddHandler('[component=\"share/google\"]', function () {\r\n\t\t\treturn openShare('https://plus.google.com/share?url=', getPostUrl($(this)), 500, 570);\r\n\t\t});\r\n\r\n\t\t$(window).trigger('action:share.addHandlers', { openShare: openShare });\r\n\t};\r\n\r\n\tfunction addHandler(selector, callback) {\r\n\t\t$('#content').off('click', selector).on('click', selector, callback);\r\n\t}\r\n\r\n\tfunction getPostUrl(clickedElement) {\r\n\t\tvar pid = parseInt(clickedElement.parents('[data-pid]').attr('data-pid'), 10);\r\n\t\treturn '/post' + (pid ? '/' + (pid) : '');\r\n\t}\r\n\r\n\treturn module;\r\n});\r\n"]}