(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define("pulling",t):e.Pulling=t()})(this,function(){"use strict";function e(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function s(){this.constructor=e}e.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}function t(e,t){if(!e){throw TypeError("Invalid arguments: "+t)}}function n(){Element.prototype.matches=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector;Object.entries=function(e){return Object.keys(e).map(function(t){return[t,e[t]]})};Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})};Object.assign=Object.assign||function(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var s=0,i=t;s<i.length;s++){var o=i[s];for(var r=0,a=Object.entries(o);r<a.length;r++){var u=a[r],l=u[0],c=u[1];e[l]=c}}return e};Array.prototype.includes=function e(t){return this.indexOf(t)!==-1}}var s=["linear","ease","ease-in","ease-out","ease-in-out","step-start","step-end"];var i=function(){function e(n){var i=this;this.styles={base:{menu:{},panel:{}},open:{menu:{},panel:{}},closed:{menu:{},panel:{}}};this.handlers={beforeclose:[],closed:[],beforeopen:[],opened:[],touchstart:[],touchmove:[],touchend:[]};this.state={opened:false,opening:false,closed:true,closing:false};this.disabled=false;if(!Object.values(e.modes).some(function(e){return i instanceof e})){throw TypeError("Calling this constructor is not allowed. "+"Use `Pulling.create` instead")}var o=n.menu,r=n.panel,a=n.side,u=n.mode,l=n.margin,c=n.timing,h=n.timingFunction,f=n.width,d=n.sensitivity,p=n.slope,m=n.touch,v=n.openPanelClass;this.menu=o;this.panel=r;this.side=a||"left";this.mode=u||"drawer";this.margin=l||25,this.timing=c||200;this.timingFunction=h||"ease";this.width=f||256;this.sensitivity=d||.25;this.slope=p||.5;this.openPanelClass=v||null;t(o instanceof Element,"`menu` must be of type `Element`");t(r instanceof Element,"`panel` must be of type `Element`");t(this.side==="left"||this.side==="right",'`side` must be equal to "left" or "right"');t(typeof this.margin==="number",'`margin` must be of type "number"');t(typeof this.timing==="number",'`timing` must be of type "number"');t(s.includes(this.timingFunction),"`timingFunction`"+" must be one of "+s.map(function(e){return'"'+e+'"'}).join(", "));t(typeof this.width==="number",'`width` must be of type "number"');t(typeof this.sensitivity==="number",'`sensitivity` must be of type "number"');t(typeof this.slope==="number",'`slope` must be of type "number"')}e.create=function(t){var n=t.mode||Object.keys(e.modes)[0]||"drawer";if(!e.modes[n]){var s=Object.keys(e.modes).map(function(e){return'"'+e+'"'}).join(", ");throw TypeError("`mode`"+" must be one of "+s)}return new e.modes[n](t)};e.prototype.emit=function(e,t){var n=this;this.handlers[e].forEach(function(e){return e.call(n,t)})};e.prototype.on=function(e,t){this.handlers[e].push(t);return this};e.prototype.off=function(e,t){if(t){this.handlers[e]=this.handlers[e].filter(function(e){return e!==t})}else{this.handlers[e]=[]}return this};e.prototype.open=function(e){var t=this;this.emit("beforeopen",e);if(this.disabled){return this}if(this.state.opened){return this}this.state.closed=false;this.state.closing=false;this.state.opening=true;this.state.opened=false;if(this.openPanelClass){document.documentElement.classList.add(this.openPanelClass)}var n=this.offset();if(n>0){var s=this.timing*(1-n/this.width)+"ms";this.menu.style.transitionDuration=s;this.panel.style.transitionDuration=s}Object.assign(this.menu.style,this.styles.open.menu);Object.assign(this.panel.style,this.styles.open.panel);var i=function(){t.state.opening=false;t.state.opened=true;Object.assign(t.menu.style,t.styles.open.menu);Object.assign(t.panel.style,t.styles.open.panel);t.emit("opened")};if(n===this.width){i()}else{this.afterTransitionend(i)}return this};e.prototype.close=function(e){var t=this;this.emit("beforeclose",e);if(this.disabled){return this}if(this.state.closed){this.state.closing=false;return this}this.state.closed=false;this.state.closing=true;this.state.opening=false;this.state.opened=false;var n=this.offset();if(n>0){var s=this.timing*n/this.width+"ms";this.menu.style.transitionDuration=s;this.panel.style.transitionDuration=s}Object.assign(this.menu.style,this.styles.closed.menu);Object.assign(this.panel.style,this.styles.closed.panel);var i=function(){t.state.closing=false;t.state.closed=true;Object.assign(t.menu.style,t.styles.closed.menu);Object.assign(t.panel.style,t.styles.closed.panel);if(t.openPanelClass){document.documentElement.classList.remove(t.openPanelClass)}t.emit("closed")};if(n===0){i()}else{this.afterTransitionend(i)}return this};e.prototype.toggle=function(e){if(e===true){this.open()}else if(e===false){this.close()}else{this.toggle(this.state.closed||this.state.closing)}return this};e.prototype.disable=function(){this.disabled=true;return this};e.prototype.enable=function(){this.disabled=false;return this};e.prototype.afterTransitionend=function(e){};e.prototype.offset=function(){return 0};e.modes={};return e}();var o=function(t){e(n,t);function n(e){var n=t.call(this,e)||this;n.touched=false;n.ignores=[];n.ignoreSelector="";n.touch=e.touch!==false;n.ignoreScrollables=e.ignoreScrollables!==false;if(n.touch){n.addTouchEvents()}return n}n.prototype.applyOffset=function(e){};n.prototype.initTouchEvents=function(){var e=this;var t=this,n=t.width,s=t.margin,i=t.side,o=t.slope,r=t.sensitivity,a=t.menu,u=t.panel;var l=i==="left"?1:-1;var c=0;var h=0;var f=0;var d=0;var p=0;var m=0;var v=0;var y=false;var g=function(e){if(!e||e===document.documentElement||e===document.body){return false}var t=getComputedStyle(e),n=t.overflowX,s=t.overflowY;return n==="auto"||n==="scroll"||n==="visible"&&s!=="visible"||g(e.parentElement)};var b=function(t){var n=t.target;if(e.ignoreSelector&&n.matches(e.ignoreSelector)){return}if(e.ignoreScrollables&&g(n)){return}e.emit("touchstart",t);if(e.disabled){return}e.touched=false;if(t.touches.length!==1){return}var o=t.touches[0],r=o.clientX,a=o.clientY;var u=e.offset();var l=s+u;if(i==="left"&&r<=l||i==="right"&&window.innerWidth-r<=l){e.touched=true;c=r;h=a;f=r;d=u;m=Date.now();y=true}};var E=function(t){e.emit("touchmove",t);if(e.disabled||!e.touched){return}var s=t.touches[0],i=s.clientX,r=s.clientY;var g=(i-c)*l;if(Math.abs(g)<10){return}if(y){var b=r-h;var E=Math.abs(b/g);if(E>o){e.touched=false;return}if(e.state.closed&&g>0){e.emit("beforeopen")}else if(e.state.opened){e.emit("beforeopen")}a.style.transition="";u.style.transition=""}if(e.state.opened&&g>0||e.state.closed&&g<0){f=i;m=Date.now();return}e.state.opened=false;e.state.closed=false;var w=(i-f)*l;var T=w>0;e.state.opening=T;e.state.closing=!T;var j=Math.min(Math.max(0,d+g),n);e.applyOffset(j);v=f;f=i;p=m;m=Date.now();y=false};var w=function(t){if(!e.touched){return}e.touched=false;if(y){return}e.emit("touchend",t);Object.assign(e.panel.style,e.styles.base.panel);Object.assign(e.menu.style,e.styles.base.menu);var s=e.offset();var i=t.changedTouches[0].clientX;var o;var a;if(i===f){o=v;a=p}else{o=f;a=m}var u=i;var c=Date.now();var h=(u-o)/(c-a)*l;if(s>n/2&&h>-r||h>r){e.open(t)}else{e.close(t)}};return{onTouchstart:b,onTouchmove:E,onTouchend:w}};n.prototype.addTouchEvents=function(){if(!this.touchEvents){this.touchEvents=this.initTouchEvents()}document.documentElement.addEventListener("touchstart",this.touchEvents.onTouchstart,false);document.documentElement.addEventListener("touchmove",this.touchEvents.onTouchmove,false);document.documentElement.addEventListener("touchend",this.touchEvents.onTouchend,false)};n.prototype.removeTouchEvents=function(){document.documentElement.removeEventListener("touchstart",this.touchEvents.onTouchstart);document.documentElement.removeEventListener("touchmove",this.touchEvents.onTouchmove);document.documentElement.removeEventListener("touchend",this.touchEvents.onTouchend)};n.prototype.ignore=function(e){this.ignores.push(e);this.ignoreSelector=this.ignores.join(", ");return this};n.prototype.unignore=function(e){this.ignores=this.ignores.filter(function(t){return t!==e});this.ignoreSelector=this.ignores.join(", ");return this};n.prototype.enableTouch=function(){if(!this.touch){this.addTouchEvents();this.touch=true}return this};n.prototype.disableTouch=function(){if(this.touch){this.removeTouchEvents();this.touch=false}return this};return n}(i);var r=function(t){e(n,t);function n(e){var n;var s=t.call(this,e)||this;s.styles.base.menu=(n={transition:"transform "+s.timing+"ms "+s.timingFunction,overflowX:"hidden",overflowY:"auto",position:"fixed"},n[s.side]="-"+s.width+"px",n.top="0",n.bottom="0",n.width=s.width+"px",n.zIndex="1",n);s.styles.open.menu={transform:"translateX("+(s.side==="right"?"-":"")+s.width+"px)"};s.styles.closed.menu={transform:"translateX(0)"};Object.assign(s.menu.style,s.styles.base.menu,s.styles.closed.menu);Object.assign(s.panel.style,s.styles.base.panel,s.styles.closed.panel);s.initTransitionend();return s}n.prototype.offset=function(){var e=this.menu.getBoundingClientRect();if(this.side==="left"){return e.left+this.width}return window.innerWidth-e.left};n.prototype.applyOffset=function(e){var t=this.side==="left"?1:-1;this.menu.style.transform="translateX("+e*t+"px)"};n.prototype.afterTransitionend=function(e){this.onTransitionend=e};n.prototype.initTransitionend=function(){var e=this;this.menu.addEventListener("transitionend",function(){if(e.onTransitionend){e.onTransitionend()}e.onTransitionend=null},false)};return n}(o);o.modes["drawer"]=r;n();return o});
//# sourceMappingURL=pulling-drawer.js.map