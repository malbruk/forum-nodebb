{"version":3,"sources":["public/src/modules/settings/array.js"],"names":["define","SettingsArray","helper","createRemoveButton","elements","rm","$","createElement","class","title","click","event","preventDefault","remove","each","i","element","is","destructElement","addArrayChildElement","field","key","attributes","value","separator","insertCb","deepClone","type","createElementOfType","tagName","attr","name","hasOwnProperty","val","search","data","substring","prop","fillField","length","add","addAddButton","addSpace","document","createTextNode","newValue","clone","el","before","append","types","use","this","create","ignored","set","_error","empty","Array","get","trim","children","values","child","readValue","isTrue","undefined","push"],"mappings":"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","file":"public/src/modules/settings/array.js","sourcesContent":["'use strict';\r\n\r\ndefine('settings/array', function () {\r\n\tvar SettingsArray;\r\n\tvar helper = null;\r\n\r\n\t/**\r\n\t Creates a new button that removes itself and the given elements on click.\r\n\t Calls {@link Settings.helper.destructElement} for each given field.\r\n\t @param elements The elements to remove on click.\r\n\t @returns JQuery The created remove-button.\r\n\t */\r\n\tfunction createRemoveButton(elements) {\r\n\t\tvar rm = $(helper.createElement('button', {\r\n\t\t\tclass: 'btn btn-xs btn-primary remove',\r\n\t\t\ttitle: 'Remove Item',\r\n\t\t}, '-'));\r\n\t\trm.click(function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\telements.remove();\r\n\t\t\trm.remove();\r\n\t\t\telements.each(function (i, element) {\r\n\t\t\t\telement = $(element);\r\n\t\t\t\tif (element.is('[data-key]')) {\r\n\t\t\t\t\thelper.destructElement(element);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn rm;\r\n\t}\r\n\r\n\t/**\r\n\t Creates a new child-element of given field with given data and calls given callback with elements to add.\r\n\t @param field Any wrapper that contains all fields of the array.\r\n\t @param key The key of the array.\r\n\t @param attributes The attributes to call {@link Settings.helper.createElementOfType} with or to add as\r\n\t element-attributes.\r\n\t @param value The value to call {@link Settings.helper.fillField} with.\r\n\t @param separator The separator to use.\r\n\t @param insertCb The callback to insert the elements.\r\n\t */\r\n\tfunction addArrayChildElement(field, key, attributes, value, separator, insertCb) {\r\n\t\tattributes = helper.deepClone(attributes);\r\n\t\tvar type = attributes['data-type'] || attributes.type || 'text';\r\n\t\tvar element = $(helper.createElementOfType(type, attributes.tagName, attributes));\r\n\t\telement.attr('data-parent', '_' + key);\r\n\t\tdelete attributes['data-type'];\r\n\t\tdelete attributes.tagName;\r\n\t\tfor (var name in attributes) {\r\n\t\t\tif (attributes.hasOwnProperty(name)) {\r\n\t\t\t\tvar val = attributes[name];\r\n\t\t\t\tif (name.search('data-') === 0) {\r\n\t\t\t\t\telement.data(name.substring(5), val);\r\n\t\t\t\t} else if (name.search('prop-') === 0) {\r\n\t\t\t\t\telement.prop(name.substring(5), val);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.attr(name, val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\thelper.fillField(element, value);\r\n\t\tif ($('[data-parent=\"_' + key + '\"]', field).length) {\r\n\t\t\tinsertCb(separator);\r\n\t\t}\r\n\t\tinsertCb(element);\r\n\t\tinsertCb(createRemoveButton(element.add(separator)));\r\n\t}\r\n\r\n\t/**\r\n\t Adds a new button that adds a new child-element to given element on click.\r\n\t @param element The element to insert the button.\r\n\t @param key The key to forward to {@link addArrayChildElement}.\r\n\t @param attributes The attributes to forward to {@link addArrayChildElement}.\r\n\t @param separator The separator to forward to {@link addArrayChildElement}.\r\n\t */\r\n\tfunction addAddButton(element, key, attributes, separator) {\r\n\t\tvar addSpace = $(document.createTextNode(' '));\r\n\t\tvar newValue = element.data('new') || '';\r\n\t\tvar add = $(helper.createElement('button', {\r\n\t\t\tclass: 'btn btn-sm btn-primary add',\r\n\t\t\ttitle: 'Expand Array',\r\n\t\t}, '+'));\r\n\t\tadd.click(function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\taddArrayChildElement(element, key, attributes, newValue, separator.clone(), function (el) {\r\n\t\t\t\taddSpace.before(el);\r\n\t\t\t});\r\n\t\t});\r\n\t\telement.append(addSpace);\r\n\t\telement.append(add);\r\n\t}\r\n\r\n\r\n\tSettingsArray = {\r\n\t\ttypes: ['array', 'div'],\r\n\t\tuse: function () {\r\n\t\t\thelper = this.helper;\r\n\t\t},\r\n\t\tcreate: function (ignored, tagName) {\r\n\t\t\treturn helper.createElement(tagName || 'div');\r\n\t\t},\r\n\t\tset: function (element, value) {\r\n\t\t\tvar attributes = element.data('attributes');\r\n\t\t\tvar key = element.data('key') || element.data('parent');\r\n\t\t\tvar separator = element.data('split') || ', ';\r\n\t\t\tseparator = (function () {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn $(separator);\r\n\t\t\t\t} catch (_error) {\r\n\t\t\t\t\treturn $(document.createTextNode(separator));\r\n\t\t\t\t}\r\n\t\t\t}());\r\n\t\t\tif (typeof attributes !== 'object') {\r\n\t\t\t\tattributes = {};\r\n\t\t\t}\r\n\t\t\telement.empty();\r\n\t\t\tif (!(value instanceof Array)) {\r\n\t\t\t\tvalue = [];\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < value.length; i += 1) {\r\n\t\t\t\taddArrayChildElement(element, key, attributes, value[i], separator.clone(), function (el) {\r\n\t\t\t\t\telement.append(el);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\taddAddButton(element, key, attributes, separator);\r\n\t\t},\r\n\t\tget: function (element, trim, empty) {\r\n\t\t\tvar key = element.data('key') || element.data('parent');\r\n\t\t\tvar children = $('[data-parent=\"_' + key + '\"]', element);\r\n\t\t\tvar values = [];\r\n\t\t\tchildren.each(function (i, child) {\r\n\t\t\t\tchild = $(child);\r\n\t\t\t\tvar val = helper.readValue(child);\r\n\t\t\t\tvar empty = helper.isTrue(child.data('empty'));\r\n\t\t\t\tif (empty || (val !== undefined && (val == null || val.length !== 0))) {\r\n\t\t\t\t\treturn values.push(val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (empty || values.length) {\r\n\t\t\t\treturn values;\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n\r\n\treturn SettingsArray;\r\n});\r\n"]}