"use strict";define("settings/sorted-list",["benchpress","hooks","jquery-ui/widgets/sortable"],function(t,a){var e;var r;e={types:["sorted-list"],use:function(){r=this},set:function(t,a){var e=t.attr("data-sorted-list");a[e]=[];t.find('[data-type="item"]').each(function(t,i){var d=$(i).attr("data-sorted-list-uuid");var s=r.helper.serializeForm($('[data-sorted-list-object="'+e+'"][data-sorted-list-uuid="'+d+'"]'));o(s);a[e].push(s)})},get:function(r,i){var d=r.find('[data-type="list"]');var o=r.attr("data-sorted-list");var n=r.attr("data-form-template");t.render(n,{}).then(function(t){var n=$('[data-sorted-list="'+o+'"] [data-type="add"]');n.on("click",function(){var a=bootbox.confirm(t,function(t){if(t){e.addItem(a.find("form").children(),r)}})});var l=r.parents("form").attr("data-socket-get");var u=ajaxify.data[l?i:"settings"][o];if(Array.isArray(u)&&typeof u[0]!=="string"){u.forEach(function(e){var i=utils.generateUUID();var n=$(t).deserialize(e);n.attr("data-sorted-list-uuid",i);n.attr("data-sorted-list-object",o);$("#content").append(n.hide());s(r,i,e).then(()=>{a.fire("action:settings.sorted-list.loaded",{element:d.get(0)})})})}});d.sortable().addClass("pointer")},addItem:function(t,a){const e=a.attr("data-sorted-list");const i=utils.generateUUID();const d=$('<form class="" data-sorted-list-uuid="'+i+'" data-sorted-list-object="'+e+'"></form>');d.append(t);$("#content").append(d.hide());const o=r.helper.serializeForm(d);s(a,i,o)}};function i(t,a){var e=t.find('[data-sorted-list-uuid="'+a+'"] [data-type="remove"]');e.on("click",function(){$('[data-sorted-list-uuid="'+a+'"]').remove()})}function d(t,a){var e=t.find('[data-type="list"]');var s=t.attr("data-sorted-list");var n=t.attr("data-item-template");var l=$('[data-sorted-list-uuid="'+a+'"] [data-type="edit"]');l.on("click",function(){var l=$('[data-sorted-list-uuid="'+a+'"][data-sorted-list-object="'+s+'"]').clone(true).show();var u=bootbox.confirm(l,function(l){if(l){var c=$('<form class="" data-sorted-list-uuid="'+a+'" data-sorted-list-object="'+s+'"></form>');c.append(u.find("form").children());$("#content").find('[data-sorted-list-uuid="'+a+'"][data-sorted-list-object="'+s+'"]').remove();$("#content").append(c.hide());var f=r.helper.serializeForm(c);o(f);app.parseAndTranslate(n,f,function(r){r=$(r);var s=e.find('[data-sorted-list-uuid="'+a+'"]');s.after(r);s.remove();r.attr("data-sorted-list-uuid",a);i(t,a);d(t,a)})}})})}function s(t,a,e){var r=t.find('[data-type="list"]');var s=t.attr("data-item-template");o(e);return new Promise(o=>{app.parseAndTranslate(s,e,function(e){e=$(e);r.append(e);e.attr("data-sorted-list-uuid",a);i(t,a);d(t,a);o()})})}function o(t){return Object.entries(t||{}).forEach(([a,e])=>{t[a]=utils.stripHTMLTags(e,utils.stripTags)})}return e});
//# sourceMappingURL=sorted-list.js.map