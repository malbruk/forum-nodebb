{"version":3,"sources":["public/src/modules/topicSelect.js"],"names":["define","components","TopicSelect","lastSelected","topicsContainer","init","onSelect","$","on","ev","preventDefault","select","this","shiftKey","selectRange","parents","attr","isSelected","hasClass","toggleSelect","toggleClass","getSelectedTids","tids","find","each","push","unselectAll","removeClass","clickedTid","first","isClickedSelected","get","clickedIndex","getIndex","lastIndex","selectIndexRange","start","end","tmp","i","topic","eq","tid","index"],"mappings":"AAAA,aAGAA,OAAO,eAAgB,cAAe,SAAUC,GAC/C,IAAIC,KACJ,IAAIC,EAEJ,IAAIC,EAEJF,EAAYG,KAAO,SAAUC,GAC5BF,EAAkBG,EAAE,0BACpBH,EAAgBI,GAAG,cAAe,6BAA8B,SAAUC,GACzEA,EAAGC,mBAGJN,EAAgBI,GAAG,QAAS,6BAA8B,SAAUC,GACnE,IAAIE,EAASJ,EAAEK,MAEf,GAAIH,EAAGI,SAAU,CAChBC,EAAYP,EAAEK,MAAMG,QAAQ,gCAAgCC,KAAK,aACjEb,EAAeQ,EACf,OAAO,MAGR,IAAIM,EAAaN,EAAOI,QAAQ,cAAcG,SAAS,YACvDC,EAAaR,GAASM,GACtBd,EAAeQ,EACf,UAAWL,IAAa,WAAY,CACnCA,QAKH,SAASa,EAAaR,EAAQM,GAC7BN,EAAOS,YAAY,oBAAqBH,GACxCN,EAAOS,YAAY,eAAgBH,GACnCN,EAAOI,QAAQ,gCAAgCK,YAAY,WAAYH,GAGxEf,EAAYmB,gBAAkB,WAC7B,IAAIC,KACJ,IAAKlB,EAAiB,CACrB,OAAOkB,EAERlB,EAAgBmB,KAAK,yCAAyCC,KAAK,WAClEF,EAAKG,KAAKlB,EAAEK,MAAMI,KAAK,eAExB,OAAOM,GAGRpB,EAAYwB,YAAc,WACzB,GAAItB,EAAiB,CACpBA,EAAgBmB,KAAK,yCAAyCI,YAAY,YAC1EvB,EAAgBmB,KAAK,8BAA8BH,YAAY,oBAAqB,OAAOA,YAAY,cAAe,QAIxH,SAASN,EAAYc,GACpB,IAAKzB,EAAc,CAClBA,EAAeI,EAAE,gCAAgCsB,QAAQN,KAAK,8BAG/D,IAAIO,EAAoB7B,EAAW8B,IAAI,iBAAkB,MAAOH,GAAYV,SAAS,YAErF,IAAIc,EAAeC,EAASL,GAC5B,IAAIM,EAAYD,EAAS9B,EAAaY,QAAQ,gCAAgCC,KAAK,aACnFmB,EAAiBH,EAAcE,GAAYJ,GAG5C,SAASK,EAAiBC,EAAOC,EAAKpB,GACrC,GAAImB,EAAQC,EAAK,CAChB,IAAIC,EAAMF,EACVA,EAAQC,EACRA,EAAMC,EAGP,IAAK,IAAIC,EAAIH,EAAOG,GAAKF,EAAKE,GAAK,EAAG,CACrC,IAAIC,EAAQjC,EAAE,gCAAgCkC,GAAGF,GACjDpB,EAAaqB,EAAMjB,KAAK,8BAA+BN,IAIzD,SAASgB,EAASS,GACjB,OAAOzC,EAAW8B,IAAI,iBAAkB,MAAOW,GAAKC,MAAM,gCAG3D,OAAOzC","file":"public/src/modules/topicSelect.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('topicSelect', ['components'], function (components) {\r\n\tvar TopicSelect = {};\r\n\tvar lastSelected;\r\n\r\n\tvar topicsContainer;\r\n\r\n\tTopicSelect.init = function (onSelect) {\r\n\t\ttopicsContainer = $('[component=\"category\"]');\r\n\t\ttopicsContainer.on('selectstart', '[component=\"topic/select\"]', function (ev) {\r\n\t\t\tev.preventDefault();\r\n\t\t});\r\n\r\n\t\ttopicsContainer.on('click', '[component=\"topic/select\"]', function (ev) {\r\n\t\t\tvar select = $(this);\r\n\r\n\t\t\tif (ev.shiftKey) {\r\n\t\t\t\tselectRange($(this).parents('[component=\"category/topic\"]').attr('data-tid'));\r\n\t\t\t\tlastSelected = select;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar isSelected = select.parents('[data-tid]').hasClass('selected');\r\n\t\t\ttoggleSelect(select, !isSelected);\r\n\t\t\tlastSelected = select;\r\n\t\t\tif (typeof onSelect === 'function') {\r\n\t\t\t\tonSelect();\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tfunction toggleSelect(select, isSelected) {\r\n\t\tselect.toggleClass('fa-check-square-o', isSelected);\r\n\t\tselect.toggleClass('fa-square-o', !isSelected);\r\n\t\tselect.parents('[component=\"category/topic\"]').toggleClass('selected', isSelected);\r\n\t}\r\n\r\n\tTopicSelect.getSelectedTids = function () {\r\n\t\tvar tids = [];\r\n\t\tif (!topicsContainer) {\r\n\t\t\treturn tids;\r\n\t\t}\r\n\t\ttopicsContainer.find('[component=\"category/topic\"].selected').each(function () {\r\n\t\t\ttids.push($(this).attr('data-tid'));\r\n\t\t});\r\n\t\treturn tids;\r\n\t};\r\n\r\n\tTopicSelect.unselectAll = function () {\r\n\t\tif (topicsContainer) {\r\n\t\t\ttopicsContainer.find('[component=\"category/topic\"].selected').removeClass('selected');\r\n\t\t\ttopicsContainer.find('[component=\"topic/select\"]').toggleClass('fa-check-square-o', false).toggleClass('fa-square-o', true);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction selectRange(clickedTid) {\r\n\t\tif (!lastSelected) {\r\n\t\t\tlastSelected = $('[component=\"category/topic\"]').first().find('[component=\"topic/select\"]');\r\n\t\t}\r\n\r\n\t\tvar isClickedSelected = components.get('category/topic', 'tid', clickedTid).hasClass('selected');\r\n\r\n\t\tvar clickedIndex = getIndex(clickedTid);\r\n\t\tvar lastIndex = getIndex(lastSelected.parents('[component=\"category/topic\"]').attr('data-tid'));\r\n\t\tselectIndexRange(clickedIndex, lastIndex, !isClickedSelected);\r\n\t}\r\n\r\n\tfunction selectIndexRange(start, end, isSelected) {\r\n\t\tif (start > end) {\r\n\t\t\tvar tmp = start;\r\n\t\t\tstart = end;\r\n\t\t\tend = tmp;\r\n\t\t}\r\n\r\n\t\tfor (var i = start; i <= end; i += 1) {\r\n\t\t\tvar topic = $('[component=\"category/topic\"]').eq(i);\r\n\t\t\ttoggleSelect(topic.find('[component=\"topic/select\"]'), isSelected);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getIndex(tid) {\r\n\t\treturn components.get('category/topic', 'tid', tid).index('[component=\"category/topic\"]');\r\n\t}\r\n\r\n\treturn TopicSelect;\r\n});\r\n"]}