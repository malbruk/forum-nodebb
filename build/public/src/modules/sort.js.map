{"version":3,"sources":["public/src/modules/sort.js"],"names":["define","components","api","module","handleSort","field","gotoOnSave","threadSort","get","find","removeClass","currentSetting","config","addClass","$","off","on","refresh","newSetting","params","qs","decodeURIComponent","param","ajaxify","go","this","attr","app","user","uid","payload","settings","put","then","utils","urlParams","sort"],"mappings":"AAAA,aAGAA,OAAO,QAAS,aAAc,OAAQ,SAAUC,EAAYC,GAC3D,IAAIC,KAEJA,EAAOC,WAAa,SAAUC,EAAOC,GACpC,IAAIC,EAAaN,EAAWO,IAAI,eAChCD,EAAWE,KAAK,KAAKC,YAAY,YACjC,IAAIC,EAAiBJ,EAAWE,KAAK,gBAAkBG,OAAOP,GAAS,MACvEM,EAAeF,KAAK,KAAKI,SAAS,YAElCC,EAAE,QACAC,IAAI,QAAS,+BACbC,GAAG,QAAS,8BAA+B,WAC3C,SAASC,EAAQC,EAAYC,GAC5BP,OAAOP,GAASa,EAChB,IAAIE,EAAKC,mBAAmBP,EAAEQ,MAAMH,IACpCI,QAAQC,GAAGlB,GAAcc,EAAK,IAAMA,EAAK,KAE1C,IAAIF,EAAaJ,EAAEW,MAAMC,KAAK,aAC9B,GAAIC,IAAIC,KAAKC,IAAK,CACjB,MAAMC,GAAYC,aAClBD,EAAQC,SAAS1B,GAASa,EAC1BhB,EAAI8B,cAAcL,IAAIC,KAAKC,eAAgBC,GAASG,KAAK,KACxDhB,EAAQC,EAAYgB,MAAMf,gBAErB,CACN,IAAIgB,EAAYD,MAAMf,SACtBgB,EAAUC,KAAOlB,EACjBD,EAAQC,EAAYiB,OAKxB,OAAOhC","file":"public/src/modules/sort.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('sort', ['components', 'api'], function (components, api) {\r\n\tvar module = {};\r\n\r\n\tmodule.handleSort = function (field, gotoOnSave) {\r\n\t\tvar threadSort = components.get('thread/sort');\r\n\t\tthreadSort.find('i').removeClass('fa-check');\r\n\t\tvar currentSetting = threadSort.find('a[data-sort=\"' + config[field] + '\"]');\r\n\t\tcurrentSetting.find('i').addClass('fa-check');\r\n\r\n\t\t$('body')\r\n\t\t\t.off('click', '[component=\"thread/sort\"] a')\r\n\t\t\t.on('click', '[component=\"thread/sort\"] a', function () {\r\n\t\t\t\tfunction refresh(newSetting, params) {\r\n\t\t\t\t\tconfig[field] = newSetting;\r\n\t\t\t\t\tvar qs = decodeURIComponent($.param(params));\r\n\t\t\t\t\tajaxify.go(gotoOnSave + (qs ? '?' + qs : ''));\r\n\t\t\t\t}\r\n\t\t\t\tvar newSetting = $(this).attr('data-sort');\r\n\t\t\t\tif (app.user.uid) {\r\n\t\t\t\t\tconst payload = { settings: {} };\r\n\t\t\t\t\tpayload.settings[field] = newSetting;\r\n\t\t\t\t\tapi.put(`/users/${app.user.uid}/settings`, payload).then(() => {\r\n\t\t\t\t\t\trefresh(newSetting, utils.params());\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar urlParams = utils.params();\r\n\t\t\t\t\turlParams.sort = newSetting;\r\n\t\t\t\t\trefresh(newSetting, urlParams);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t};\r\n\r\n\treturn module;\r\n});\r\n"]}