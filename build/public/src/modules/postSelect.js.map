{"version":3,"sources":["public/src/modules/postSelect.js"],"names":["define","components","PostSelect","onSelect","pids","allowMainPostSelect","init","_onSelect","options","length","$","on","onPostClicked","disableClicksOnPosts","ev","stopPropagation","pidClicked","this","attr","postEls","parseInt","togglePostSelection","disable","forEach","pid","get","toggleClass","off","enableClicksOnPosts","index","indexOf","push","splice","sort","a","b","disableClicks"],"mappings":"AAAA,aAGAA,OAAO,cAAe,cAAe,SAAUC,GAC9C,IAAIC,KACJ,IAAIC,EAEJD,EAAWE,QAEX,IAAIC,EAAsB,MAE1BH,EAAWI,KAAO,SAAUC,EAAWC,GACtCN,EAAWE,KAAKK,OAAS,EACzBN,EAAWI,EACXC,EAAUA,MACVH,EAAsBG,EAAQH,qBAAuB,MACrDK,EAAE,YAAYC,GAAG,QAAS,yCAA0CC,GACpEC,KAGD,SAASD,EAAcE,GACtBA,EAAGC,kBACH,IAAIC,EAAaN,EAAEO,MAAMC,KAAK,YAC9B,IAAIC,EAAUT,EAAE,kCAAoCM,EAAa,MACjE,IAAKX,GAAuBe,SAASV,EAAEO,MAAMC,KAAK,cAAe,MAAQ,EAAG,CAC3E,OAEDhB,EAAWmB,oBAAoBF,EAASH,GAGzCd,EAAWoB,QAAU,WACpBpB,EAAWE,KAAKmB,QAAQ,SAAUC,GACjCvB,EAAWwB,IAAI,OAAQ,MAAOD,GAAKE,YAAY,aAAc,SAG9DhB,EAAE,YAAYiB,IAAI,QAAS,yCAA0Cf,GACrEgB,KAGD1B,EAAWmB,oBAAsB,SAAUF,EAASK,GACnD,GAAIA,EAAK,CACR,IAAIK,EAAQ3B,EAAWE,KAAK0B,QAAQN,GACpC,GAAIK,KAAW,EAAG,CACjB3B,EAAWE,KAAK2B,KAAKP,GACrBL,EAAQO,YAAY,aAAc,UAC5B,CACNxB,EAAWE,KAAK4B,OAAOH,EAAO,GAC9BV,EAAQO,YAAY,aAAc,OAGnC,GAAIxB,EAAWE,KAAKK,OAAQ,CAC3BP,EAAWE,KAAK6B,KAAK,SAAUC,EAAGC,GAAK,OAAOD,EAAIC,IAEnD,UAAWhC,IAAa,WAAY,CACnCA,OAKH,SAASiC,IACR,OAAO,MAGR,SAASvB,IACRH,EAAE,YAAYC,GAAG,QAAS,kDAAmDyB,GAG9E,SAASR,IACRlB,EAAE,YAAYiB,IAAI,QAAS,kDAAmDS,GAG/E,OAAOlC","file":"public/src/modules/postSelect.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('postSelect', ['components'], function (components) {\r\n\tvar PostSelect = {};\r\n\tvar onSelect;\r\n\r\n\tPostSelect.pids = [];\r\n\r\n\tvar allowMainPostSelect = false;\r\n\r\n\tPostSelect.init = function (_onSelect, options) {\r\n\t\tPostSelect.pids.length = 0;\r\n\t\tonSelect = _onSelect;\r\n\t\toptions = options || {};\r\n\t\tallowMainPostSelect = options.allowMainPostSelect || false;\r\n\t\t$('#content').on('click', '[component=\"topic\"] [component=\"post\"]', onPostClicked);\r\n\t\tdisableClicksOnPosts();\r\n\t};\r\n\r\n\tfunction onPostClicked(ev) {\r\n\t\tev.stopPropagation();\r\n\t\tvar pidClicked = $(this).attr('data-pid');\r\n\t\tvar postEls = $('[component=\"topic\"] [data-pid=\"' + pidClicked + '\"]');\r\n\t\tif (!allowMainPostSelect && parseInt($(this).attr('data-index'), 10) === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tPostSelect.togglePostSelection(postEls, pidClicked);\r\n\t}\r\n\r\n\tPostSelect.disable = function () {\r\n\t\tPostSelect.pids.forEach(function (pid) {\r\n\t\t\tcomponents.get('post', 'pid', pid).toggleClass('bg-success', false);\r\n\t\t});\r\n\r\n\t\t$('#content').off('click', '[component=\"topic\"] [component=\"post\"]', onPostClicked);\r\n\t\tenableClicksOnPosts();\r\n\t};\r\n\r\n\tPostSelect.togglePostSelection = function (postEls, pid) {\r\n\t\tif (pid) {\r\n\t\t\tvar index = PostSelect.pids.indexOf(pid);\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tPostSelect.pids.push(pid);\r\n\t\t\t\tpostEls.toggleClass('bg-success', true);\r\n\t\t\t} else {\r\n\t\t\t\tPostSelect.pids.splice(index, 1);\r\n\t\t\t\tpostEls.toggleClass('bg-success', false);\r\n\t\t\t}\r\n\r\n\t\t\tif (PostSelect.pids.length) {\r\n\t\t\t\tPostSelect.pids.sort(function (a, b) { return a - b; });\r\n\t\t\t}\r\n\t\t\tif (typeof onSelect === 'function') {\r\n\t\t\t\tonSelect();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction disableClicks() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction disableClicksOnPosts() {\r\n\t\t$('#content').on('click', '[component=\"post\"] button, [component=\"post\"] a', disableClicks);\r\n\t}\r\n\r\n\tfunction enableClicksOnPosts() {\r\n\t\t$('#content').off('click', '[component=\"post\"] button, [component=\"post\"] a', disableClicks);\r\n\t}\r\n\r\n\treturn PostSelect;\r\n});\r\n"]}