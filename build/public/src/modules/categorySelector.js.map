{"version":3,"sources":["public/src/modules/categorySelector.js"],"names":["define","categorySearch","bootbox","categorySelector","init","el","options","length","onSelect","states","template","$","window","trigger","selector","selectedCategory","on","categoryEl","this","hasClass","selectCategory","attr","cid","find","name","html","translateHtml","selectCategoryLabel","getSelectedCategory","getSelectedCid","modal","onSubmit","app","parseAndTranslate","dialog","title","message","buttons","save","label","className","callback","submit","ev","preventDefault","openOnLoad","dropdown"],"mappings":"AAAA,aAEAA,OAAO,oBACN,iBAAkB,WAChB,SAAUC,EAAgBC,GAC5B,IAAIC,KAEJA,EAAiBC,KAAO,SAAUC,EAAIC,GACrC,IAAKD,IAAOA,EAAGE,OAAQ,CACtB,OAEDD,EAAUA,MACV,IAAIE,EAAWF,EAAQE,UAAY,aAEnCF,EAAQG,OAASH,EAAQG,SAAW,WAAY,cAAe,YAC/DH,EAAQI,SAAW,6BACnBC,EAAEC,QAAQC,QAAQ,oCAAsCR,GAAIA,EAAIC,QAASA,IAEzEL,EAAeG,KAAKC,EAAIC,GAExB,IAAIQ,GACHT,GAAIA,EACJU,iBAAkB,MAEnBV,EAAGW,GAAG,QAAS,aAAc,WAC5B,IAAIC,EAAaN,EAAEO,MACnB,GAAID,EAAWE,SAAS,YAAa,CACpC,OAAO,MAERL,EAASM,eAAeH,EAAWI,KAAK,aACxCb,EAASM,EAASC,oBAGnBD,EAASM,eAAiB,SAAUE,GACnC,IAAIL,EAAaH,EAAST,GAAGkB,KAAK,cAAgBD,EAAM,MACxDR,EAASC,kBACRO,IAAKA,EACLE,KAAMP,EAAWI,KAAK,cAGvB,GAAIJ,EAAWV,OAAQ,CACtBO,EAAST,GAAGkB,KAAK,4CAA4CE,KAC5DR,EAAWM,KAAK,iCAAiCE,YAE5C,CACNX,EAAST,GAAGkB,KAAK,4CAA4CG,cAC5DpB,EAAQqB,qBAAuB,4CAIlCb,EAASc,oBAAsB,WAC9B,OAAOd,EAASC,kBAEjBD,EAASe,eAAiB,WACzB,OAAOf,EAASC,iBAAmBD,EAASC,iBAAiBO,IAAM,GAEpE,OAAOR,GAGRX,EAAiB2B,MAAQ,SAAUxB,GAClCA,EAAUA,MACVA,EAAQE,SAAWF,EAAQE,UAAY,aACvCF,EAAQyB,SAAWzB,EAAQyB,UAAY,aACvCC,IAAIC,kBAAkB,+CAAiD,SAAUR,GAChF,IAAIK,EAAQ5B,EAAQgC,QACnBC,MAAO,uCACPC,QAASX,EACTY,SACCC,MACCC,MAAO,oBACPC,UAAW,cACXC,SAAUC,MAKb,IAAI5B,EAAWX,EAAiBC,KAAK0B,EAAMP,KAAK,mCAAoCjB,GACpF,SAASoC,EAAOC,GACfA,EAAGC,iBACH,GAAI9B,EAASC,iBAAkB,CAC9BT,EAAQyB,SAASjB,EAASC,kBAC1Be,EAAMA,MAAM,QAEb,OAAO,MAER,GAAIxB,EAAQuC,WAAY,CACvBf,EAAMd,GAAG,iBAAkB,WAC1Bc,EAAMP,KAAK,oBAAoBuB,SAAS,YAG1ChB,EAAMP,KAAK,QAAQP,GAAG,SAAU0B,MAIlC,OAAOvC","file":"public/src/modules/categorySelector.js","sourcesContent":["'use strict';\r\n\r\ndefine('categorySelector', [\r\n\t'categorySearch', 'bootbox',\r\n], function (categorySearch, bootbox) {\r\n\tvar categorySelector = {};\r\n\r\n\tcategorySelector.init = function (el, options) {\r\n\t\tif (!el || !el.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\toptions = options || {};\r\n\t\tvar onSelect = options.onSelect || function () {};\r\n\r\n\t\toptions.states = options.states || ['watching', 'notwatching', 'ignoring'];\r\n\t\toptions.template = 'partials/category-selector';\r\n\t\t$(window).trigger('action:category.selector.options', { el: el, options: options });\r\n\r\n\t\tcategorySearch.init(el, options);\r\n\r\n\t\tvar selector = {\r\n\t\t\tel: el,\r\n\t\t\tselectedCategory: null,\r\n\t\t};\r\n\t\tel.on('click', '[data-cid]', function () {\r\n\t\t\tvar categoryEl = $(this);\r\n\t\t\tif (categoryEl.hasClass('disabled')) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tselector.selectCategory(categoryEl.attr('data-cid'));\r\n\t\t\tonSelect(selector.selectedCategory);\r\n\t\t});\r\n\r\n\t\tselector.selectCategory = function (cid) {\r\n\t\t\tvar categoryEl = selector.el.find('[data-cid=\"' + cid + '\"]');\r\n\t\t\tselector.selectedCategory = {\r\n\t\t\t\tcid: cid,\r\n\t\t\t\tname: categoryEl.attr('data-name'),\r\n\t\t\t};\r\n\r\n\t\t\tif (categoryEl.length) {\r\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').html(\r\n\t\t\t\t\tcategoryEl.find('[component=\"category-markup\"]').html()\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').translateHtml(\r\n\t\t\t\t\toptions.selectCategoryLabel || '[[topic:thread_tools.select_category]]'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t};\r\n\t\tselector.getSelectedCategory = function () {\r\n\t\t\treturn selector.selectedCategory;\r\n\t\t};\r\n\t\tselector.getSelectedCid = function () {\r\n\t\t\treturn selector.selectedCategory ? selector.selectedCategory.cid : 0;\r\n\t\t};\r\n\t\treturn selector;\r\n\t};\r\n\r\n\tcategorySelector.modal = function (options) {\r\n\t\toptions = options || {};\r\n\t\toptions.onSelect = options.onSelect || function () {};\r\n\t\toptions.onSubmit = options.onSubmit || function () {};\r\n\t\tapp.parseAndTranslate('admin/partials/categories/select-category', {}, function (html) {\r\n\t\t\tvar modal = bootbox.dialog({\r\n\t\t\t\ttitle: '[[modules:composer.select_category]]',\r\n\t\t\t\tmessage: html,\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tsave: {\r\n\t\t\t\t\t\tlabel: '[[global:select]]',\r\n\t\t\t\t\t\tclassName: 'btn-primary',\r\n\t\t\t\t\t\tcallback: submit,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t});\r\n\r\n\t\t\tvar selector = categorySelector.init(modal.find('[component=\"category-selector\"]'), options);\r\n\t\t\tfunction submit(ev) {\r\n\t\t\t\tev.preventDefault();\r\n\t\t\t\tif (selector.selectedCategory) {\r\n\t\t\t\t\toptions.onSubmit(selector.selectedCategory);\r\n\t\t\t\t\tmodal.modal('hide');\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (options.openOnLoad) {\r\n\t\t\t\tmodal.on('shown.bs.modal', function () {\r\n\t\t\t\t\tmodal.find('.dropdown-toggle').dropdown('toggle');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tmodal.find('form').on('submit', submit);\r\n\t\t});\r\n\t};\r\n\r\n\treturn categorySelector;\r\n});\r\n"]}